[
  {
    "objectID": "0.intro.html",
    "href": "0.intro.html",
    "title": "环境健康领域简介",
    "section": "",
    "text": "环境流行病学是环境卫生学中的一门分支学科。是应用流行病学的原理与方法研究环境因素对人群健康状况影响的一门学科。\n环境流行病学肇始于地球化学性疾病的研究 (如地方性甲状腺肿、地方性氟中毒等)。自从“污染物”成为重要的环境因素以来，陆续发现一些原因不明的疾病与环境中的污染物有关，这种情况随着工业的迅速发展而日益显著和严重，以至在五十年代和六十年代酿成震惊世界的严重公害病事件，如发生在日本的水俣病(长期食含汞量高的鱼引起的甲基汞中毒)和痛痛病(长期食含镉量高的米而引起的慢性镉中毒)。\n环境污染与人群健康的关系，在世界范围，曾开展过广泛的研究，而这种研究一开始几乎都是流行病学调查研究。流行病学研究方法在这个领域中得到充分的运用和发展，逐渐形成具有自身特点的环境流行病学方法。由于对公害病的深入研究，在七十年代出现了一批环境流行病学的代表性文献。以后有人提出了“污染物的生物反应谱”概念，进一步概括了环境污染与人群健康状况之间关系的一般规律。\n\n环境流行病学的研究范围与内容\n\n调查并描述污染物(健康危害物)在区域环境各要素(空气、土壤、水体、生物)中的分布、负荷水平、时空波动、理化形态、转化规律、人群平均暴露水平和暴露条件(环境病因条件)等。\n调查并描述区域环境中暴露人群的健康状况构成 (生物反应谱)、地区、人群分布(按年龄、性别、职业、生活条件等特征分组)。\n研究环境污染物负荷与人群健康影响的对应关系即暴露一效应关系，确立剂量反应曲线。以此为基础，研究污染物的阈限负荷，制订环境质量标准，进而确定污染物的环境生物学容量。\n对原因未明的环境性疾病或人群健康异常进行流行病学的调查与分析，提出环境病因学线索，查明疾病与健康损害的直接原因。\n研究环境健康影响的各因素联系以及诸环境因素相互作用及其对健康的影响。"
  },
  {
    "objectID": "1.exposure.html",
    "href": "1.exposure.html",
    "title": "环境暴露评估",
    "section": "",
    "text": "CHAP (ChinaHighAirPollutants)，由马里兰大学的研究院韦晶博士团队生成，使用数据免费，但需要跟韦博士签订协议， 高质量的文章需要带韦博士为共同通讯作者。CHAP数据种类多，空间精度高（大部分为1*1km的空间精度和日均数据），包含的污染物包括：\n\nPM\\(_{1}\\) （1*1km，日均数据）2000-2021年\nPM\\(_{2.5}\\) （1*1km，日均数据）2000-2021年\nPM\\(_{10}\\) （1*1km，日均数据）2000-2021年\n臭氧（O\\(_3\\)）（1*1km，日均数据）2000年至今\n二氧化氮（NO\\(_2\\)）（10*10km，日均数据）2008年至今\n二氧化硫（SO\\(_2\\)）（10*10km，日均数据）2008年至今\n一氧化碳（CO）（10*10km，日均数据）2013年至今\n6种PM\\(_{2.5}\\)化学组分（1*1km，日均数据）2000年至今\n\n黑碳（black carbon）\n有机物（organic matter）\n硫酸盐（sulphate, SO\\(_4^{2-}\\)）\n硝酸盐（nitrate, NO\\(_3^-\\)）\n铵盐（ammonium, NH\\(_4^+\\)）\n氯化物（ammonium, Cl\\(^-\\)）\n\n16种环境多环芳烃（outdoor polycyclic aromatic hydrocarbons, PAHs）\n\nnaphthalene (Nap)\nacenaphthene (Ace),\nacenaphthylene (Acy),\nfluorene (Flu),\nphenanthrene (Phe),\nanthracene (Ant),\nfluoranthene (Fla),\npyrene (Pyr),\nbenz[a]anthracene (BaA),\nchrysene (Chr),\nbenzo[b]fluoranthene (BbF),\nbenzo[k]fluoranthene (BkF),\nbenzo[a]pyrene (BaP),\ndibenz[a,h]anthracene (DahA),\nbenzo[ghi]perylene (BghiP)\nindeno[1,2,3-cd] pyrene (IcdP)\n\n\n\n\n\nTAP (Tracking Air Pollution in China) 中国大气成分近实时追踪数据集，由清华大学的TAP团队开发。免费+开源，空间精度较低，现有10*10km的网格化数据产品，包含的污染物包括：\n\nPM\\(_{2.5}\\) （1*1km，日均数据）2000年至今\nPM\\(_{2.5}\\)化学组分 （10*10km，日均数据）2000年至今\n\n黑碳（black carbon）\n有机物（organic matter）\n硫酸盐（sulphate, SO\\(_4^{2-}\\)）\n硝酸盐（nitrate, NO\\({_3^-}\\)）\n铵盐（ammonium, NH\\(_4^+\\)）\n\n臭氧（O\\(_3\\)）（10*10km，日均数据）2013年至今"
  },
  {
    "objectID": "1.exposure.html#空气污染",
    "href": "1.exposure.html#空气污染",
    "title": "环境暴露评估",
    "section": "",
    "text": "CHAP (ChinaHighAirPollutants)，由马里兰大学的研究院韦晶博士团队生成，使用数据免费，但需要跟韦博士签订协议， 高质量的文章需要带韦博士为共同通讯作者。CHAP数据种类多，空间精度高（大部分为1*1km的空间精度和日均数据），包含的污染物包括：\n\nPM\\(_{1}\\) （1*1km，日均数据）2000-2021年\nPM\\(_{2.5}\\) （1*1km，日均数据）2000-2021年\nPM\\(_{10}\\) （1*1km，日均数据）2000-2021年\n臭氧（O\\(_3\\)）（1*1km，日均数据）2000年至今\n二氧化氮（NO\\(_2\\)）（10*10km，日均数据）2008年至今\n二氧化硫（SO\\(_2\\)）（10*10km，日均数据）2008年至今\n一氧化碳（CO）（10*10km，日均数据）2013年至今\n6种PM\\(_{2.5}\\)化学组分（1*1km，日均数据）2000年至今\n\n黑碳（black carbon）\n有机物（organic matter）\n硫酸盐（sulphate, SO\\(_4^{2-}\\)）\n硝酸盐（nitrate, NO\\(_3^-\\)）\n铵盐（ammonium, NH\\(_4^+\\)）\n氯化物（ammonium, Cl\\(^-\\)）\n\n16种环境多环芳烃（outdoor polycyclic aromatic hydrocarbons, PAHs）\n\nnaphthalene (Nap)\nacenaphthene (Ace),\nacenaphthylene (Acy),\nfluorene (Flu),\nphenanthrene (Phe),\nanthracene (Ant),\nfluoranthene (Fla),\npyrene (Pyr),\nbenz[a]anthracene (BaA),\nchrysene (Chr),\nbenzo[b]fluoranthene (BbF),\nbenzo[k]fluoranthene (BkF),\nbenzo[a]pyrene (BaP),\ndibenz[a,h]anthracene (DahA),\nbenzo[ghi]perylene (BghiP)\nindeno[1,2,3-cd] pyrene (IcdP)\n\n\n\n\n\nTAP (Tracking Air Pollution in China) 中国大气成分近实时追踪数据集，由清华大学的TAP团队开发。免费+开源，空间精度较低，现有10*10km的网格化数据产品，包含的污染物包括：\n\nPM\\(_{2.5}\\) （1*1km，日均数据）2000年至今\nPM\\(_{2.5}\\)化学组分 （10*10km，日均数据）2000年至今\n\n黑碳（black carbon）\n有机物（organic matter）\n硫酸盐（sulphate, SO\\(_4^{2-}\\)）\n硝酸盐（nitrate, NO\\({_3^-}\\)）\n铵盐（ammonium, NH\\(_4^+\\)）\n\n臭氧（O\\(_3\\)）（10*10km，日均数据）2013年至今"
  },
  {
    "objectID": "1.exposure.html#短期",
    "href": "1.exposure.html#短期",
    "title": "环境暴露评估",
    "section": "短期",
    "text": "短期"
  },
  {
    "objectID": "1.exposure.html#长期",
    "href": "1.exposure.html#长期",
    "title": "环境暴露评估",
    "section": "长期",
    "text": "长期"
  },
  {
    "objectID": "1.exposure.html#地区水平",
    "href": "1.exposure.html#地区水平",
    "title": "环境暴露评估",
    "section": "地区水平",
    "text": "地区水平"
  },
  {
    "objectID": "1.exposure.html#个体水平",
    "href": "1.exposure.html#个体水平",
    "title": "环境暴露评估",
    "section": "个体水平：",
    "text": "个体水平：\n\n个体文本地址转经纬度\n四川大学公共卫生学院的林小军教授开发的amapR，可使用高德地图API把具体的文本类型的地址转换成数值型的经纬度。\n\n\n根据经纬度的双线性插值暴露评估"
  },
  {
    "objectID": "2.ts.html",
    "href": "2.ts.html",
    "title": "时间序列研究",
    "section": "",
    "text": "Liu, C., Chen, R., Sera, F., Vicedo-Cabrera, A. M., Guo, Y., Tong, S., … & Kan, H. (2019). Ambient particulate air pollution and daily mortality in 652 cities. New England Journal of Medicine (IF=176), 381(8), 705-715. PDF \nChen, G., Guo, Y., Yue, X., Tong, S., Gasparrini, A., Bell, M. L., … & Li, S. (2021). Mortality risk attributable to wildfire-related PM\\(_{2.5}\\) pollution: a global time series study in 749 locations. The Lancet Planetary Health (IF=29), 5(9), e579-e587. PDF \nChen, R., Yin, P., Wang, L., Liu, C., Niu, Y., Wang, W., … & Zhou, M. (2018). Association between ambient temperature and mortality risk and burden: time series study in 272 main Chinese cities. BMJ (IF=93), 363.\nChen, R., Yin, P., Meng, X., Liu, C., Wang, L., Xu, X., … & Zhou, M. (2017). Fine particulate air pollution and daily mortality. A nationwide analysis in 272 Chinese cities. American journal of Respiratory and Critical Care Medicine (IF=31), 196(1), 73-81.\n\n\n\n\n两阶段模型法\n\n\n广义加性线性模型（generalized additive model）：\n\n计数型因变量（如发病人数）–&gt; 类泊松连接函数\n连续型因变量（如YLL ） –&gt; 高斯连接函数\n\n\\[\\log E(Y_t) = \\alpha + \\beta_0 \\times\\text{PM}_{2.5} \\\\\n+ \\beta_1 \\times\\text{day of week}\\\\\n+ \\beta_2 \\times\\text{public holidays}\\\\\ns(t, \\text{df} = \\frac{6}{\\text{year}}) \\\\\n+ s(\\text{temperature}, \\text{df} = 6)\\\\\n+ s(\\text{relative humidity}, \\text{df} = 6) \\]\n\n\n\nI\\(^2\\)统计量用来评价不同城市间的异质性。"
  },
  {
    "objectID": "2.ts.html#背景与参考文献",
    "href": "2.ts.html#背景与参考文献",
    "title": "时间序列研究",
    "section": "",
    "text": "Liu, C., Chen, R., Sera, F., Vicedo-Cabrera, A. M., Guo, Y., Tong, S., … & Kan, H. (2019). Ambient particulate air pollution and daily mortality in 652 cities. New England Journal of Medicine (IF=176), 381(8), 705-715. PDF \nChen, G., Guo, Y., Yue, X., Tong, S., Gasparrini, A., Bell, M. L., … & Li, S. (2021). Mortality risk attributable to wildfire-related PM\\(_{2.5}\\) pollution: a global time series study in 749 locations. The Lancet Planetary Health (IF=29), 5(9), e579-e587. PDF \nChen, R., Yin, P., Wang, L., Liu, C., Niu, Y., Wang, W., … & Zhou, M. (2018). Association between ambient temperature and mortality risk and burden: time series study in 272 main Chinese cities. BMJ (IF=93), 363.\nChen, R., Yin, P., Meng, X., Liu, C., Wang, L., Xu, X., … & Zhou, M. (2017). Fine particulate air pollution and daily mortality. A nationwide analysis in 272 Chinese cities. American journal of Respiratory and Critical Care Medicine (IF=31), 196(1), 73-81."
  },
  {
    "objectID": "2.ts.html#模型",
    "href": "2.ts.html#模型",
    "title": "时间序列研究",
    "section": "",
    "text": "两阶段模型法\n\n\n广义加性线性模型（generalized additive model）：\n\n计数型因变量（如发病人数）–&gt; 类泊松连接函数\n连续型因变量（如YLL ） –&gt; 高斯连接函数\n\n\\[\\log E(Y_t) = \\alpha + \\beta_0 \\times\\text{PM}_{2.5} \\\\\n+ \\beta_1 \\times\\text{day of week}\\\\\n+ \\beta_2 \\times\\text{public holidays}\\\\\ns(t, \\text{df} = \\frac{6}{\\text{year}}) \\\\\n+ s(\\text{temperature}, \\text{df} = 6)\\\\\n+ s(\\text{relative humidity}, \\text{df} = 6) \\]\n\n\n\nI\\(^2\\)统计量用来评价不同城市间的异质性。"
  },
  {
    "objectID": "2.ts.html#数据读取与检查",
    "href": "2.ts.html#数据读取与检查",
    "title": "时间序列研究",
    "section": "数据读取与检查",
    "text": "数据读取与检查\n\npacman::p_load(lubridate, glue, tidyr, purrr, broom, mgcv, dplyr, data.table, ggplot2)\n\nts_city = arrow::read_parquet('Data/ts_synthetic.parquet') %&gt;% \n  mutate(admit_date_int = as.integer(admit_date))\n\nglimpse(ts_city)\n\nRows: 22,958\nColumns: 13\n$ City              &lt;chr&gt; \"city_01\", \"city_01\", \"city_01\", \"city_01\", \"city_01…\n$ admit_date        &lt;date&gt; 2014-01-01, 2014-01-02, 2014-01-03, 2014-01-04, 201…\n$ N                 &lt;int&gt; 71, 30, 53, 37, 33, 27, 26, 41, 46, 38, 30, 30, 40, …\n$ PM2.5_MA_07       &lt;dbl&gt; 43.48810, 47.60833, 53.47381, 59.12381, 61.48333, 62…\n$ SO4_MA_07         &lt;dbl&gt; 8.103643, 8.859619, 9.862833, 10.802631, 10.981190, …\n$ NO3_MA_07         &lt;dbl&gt; 11.321107, 12.452488, 14.035452, 15.446714, 15.80534…\n$ NH4_MA_07         &lt;dbl&gt; 7.374893, 8.115286, 9.126012, 10.078940, 10.428202, …\n$ OM_MA_07          &lt;dbl&gt; 10.740298, 11.796440, 13.649619, 15.619893, 16.65766…\n$ BC_MA_07          &lt;dbl&gt; 1.664417, 1.873250, 2.214726, 2.557393, 2.782690, 2.…\n$ Temperature_MA_07 &lt;dbl&gt; 8.647635, 8.697264, 9.145584, 9.433634, 9.423733, 10…\n$ RH_MA_07          &lt;dbl&gt; 75.89122, 74.89766, 76.77965, 79.10466, 80.76195, 79…\n$ dow               &lt;ord&gt; Sunday, Monday, Tuesday, Wednesday, Thursday, Friday…\n$ admit_date_int    &lt;int&gt; 16071, 16072, 16073, 16074, 16075, 16076, 16077, 160…\n\n\n\nfit_ts_sep = function(pm_components, df_date, y, dat){\n  \n  fit_model = glue('{y} ~ {pm_components} +\n                    s(admit_date_int, k = {df_date}, fx = T, bs = \"cr\") +\n                    dow + s(Temperature_MA_07, k = 6) +\n                    s(RH_MA_07, k = 6)') %&gt;%\n    as.formula() %&gt;%\n    gam(family = quasipoisson(link = \"log\"),\n        scale = -1,\n        control = gam.control(epsilon = 0.0000001,\n                              maxit = 1000),\n        na.action = na.omit,\n        data = dat)\n  \n  coef_vec = summary(fit_model)$p.coeff\n  se_vec = summary(fit_model)$se\n  pval_vec = summary(fit_model)$p.pv\n  \n  coef_point = coef_vec[names(coef_vec) == pm_components]\n  se_point = se_vec[names(se_vec) == pm_components]\n  pval_point = pval_vec[names(pval_vec) == pm_components]\n  \n  ER = (exp(coef_point) - 1)*100\n  CI_lower = (exp(coef_point - 1.96*se_point) - 1)*100\n  CI_upper = (exp(coef_point + 1.96*se_point) - 1)*100\n  \n  ER_95CI = glue(\"{formatC(round(ER, 2), format = 'f', digits = 2)} \",\n                 \"({formatC(round(CI_lower, 2), format = 'f', digits = 2)} to \",\n                 \"{formatC(round(CI_upper, 2), format = 'f', digits = 2)})\")\n  \n  output = data.table(\n    pm_components = pm_components, \n    #pm_component_IQR = formatC(round(IQR_range, 2), format = 'f', digits = 2), \n    n = dat[,.N],\n    ER_95CI = ER_95CI,\n    ER = ER, \n    CI_lower = CI_lower, \n    CI_upper = CI_upper, \n    p_value = pval_point,\n    log_OR = coef_point, \n    log_OR_se = se_point)\n  \n  return(output)\n}\n\nmap_city = function(dat, df_date, y){\n  \n  #pb$tick()$print()\n  df_date_vector = rep(df_date, length(pollutant_vec7))\n  \n  res = map2_dfr(pollutant_vec7, df_date, fit_ts_sep, dat = dat, y = y)\n  \n  return(res)\n}"
  },
  {
    "objectID": "2.ts.html#第一阶段gam建模",
    "href": "2.ts.html#第一阶段gam建模",
    "title": "时间序列研究",
    "section": "第一阶段GAM建模",
    "text": "第一阶段GAM建模\n\n计算各污染物的四分位间距\n\npollutant_vec7 = c(\n  \"PM2.5_MA_07\", \"BC_MA_07\", \"OM_MA_07\", \"SO4_MA_07\", \"NO3_MA_07\", \"NH4_MA_07\")\n\nIQR_pollutant = map_dfr(\n  pollutant_vec7,\n  ~data.table(pollutant = .x, \n              IQR = IQR(ts_city[[.x]], na.rm = TRUE)))\n\nIQR_pollutant\n\n     pollutant        IQR\n1: PM2.5_MA_07 22.6991687\n2:    BC_MA_07  0.9554241\n3:    OM_MA_07  5.6129462\n4:   SO4_MA_07  4.1445419\n5:   NO3_MA_07  6.7363995\n6:   NH4_MA_07  4.3471178\n\n\n\n\n设置各个城市的观测时长的自由度\n\ncity_obs_length = ts_city %&gt;% \n  group_by(City) %&gt;% \n  summarise(admit_date_min = min(admit_date),\n            admit_date_max = max(admit_date),\n            obs_length = as.integer(max(admit_date) - min(admit_date))/365,\n            df = round(obs_length)*4) %&gt;% \n  ungroup()\n\ncity_obs_length\n\n# A tibble: 21 × 5\n   City    admit_date_min admit_date_max obs_length    df\n   &lt;chr&gt;   &lt;date&gt;         &lt;date&gt;              &lt;dbl&gt; &lt;dbl&gt;\n 1 city_01 2014-01-01     2016-12-30           3.00    12\n 2 city_02 2014-01-01     2016-12-30           3.00    12\n 3 city_03 2014-01-01     2016-12-30           3.00    12\n 4 city_04 2014-01-01     2016-12-30           3.00    12\n 5 city_05 2014-01-01     2016-12-30           3.00    12\n 6 city_06 2014-01-01     2016-12-30           3.00    12\n 7 city_07 2014-01-01     2016-12-30           3.00    12\n 8 city_08 2014-01-01     2016-12-30           3.00    12\n 9 city_09 2014-01-01     2016-12-29           2.99    12\n10 city_10 2014-01-01     2016-12-30           3.00    12\n# ℹ 11 more rows\n\n\n\n\n分城市进行建模\n\nmodels_city = ts_city %&gt;% \n  mutate(across(PM2.5_MA_07:BC_MA_07, ~.x/IQR(.x))) %&gt;% \n  group_by(City) %&gt;% \n  nest() %&gt;%\n  left_join(city_obs_length %&gt;% \n              dplyr::select(City, df),\n            by = 'City') %&gt;% \n  mutate(models = map2(data, df, map_city, y = 'N'))\n\nmodels_city\n\n# A tibble: 21 × 4\n# Groups:   City [21]\n   City    data                     df models      \n   &lt;chr&gt;   &lt;list&gt;                &lt;dbl&gt; &lt;list&gt;      \n 1 city_01 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n 2 city_02 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n 3 city_03 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n 4 city_04 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n 5 city_05 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n 6 city_06 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n 7 city_07 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n 8 city_08 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n 9 city_09 &lt;tibble [1,094 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n10 city_10 &lt;tibble [1,095 × 12]&gt;    12 &lt;dt [6 × 8]&gt;\n# ℹ 11 more rows\n\n\n\n\n计算各城市的模型估计值\n\nestimate_city = models_city %&gt;% \n  select(-data) %&gt;% \n  unnest(cols = c(models)) %&gt;% \n  setDT()\nestimate_city\n\n        City df pm_components               ER_95CI         ER   CI_lower\n  1: city_01 12   PM2.5_MA_07  0.79 (-2.83 to 4.55)  0.7930900 -2.8296791\n  2: city_01 12      BC_MA_07 -0.85 (-3.47 to 1.83) -0.8534384 -3.4659267\n  3: city_01 12      OM_MA_07 -0.51 (-3.34 to 2.40) -0.5118881 -3.3424207\n  4: city_01 12     SO4_MA_07  2.59 (-1.14 to 6.46)  2.5889907 -1.1405705\n  5: city_01 12     NO3_MA_07  1.55 (-2.76 to 6.05)  1.5528460 -2.7551925\n ---                                                                     \n122: city_21 12      BC_MA_07  0.38 (-5.67 to 6.82)  0.3789915 -5.6708142\n123: city_21 12      OM_MA_07 5.76 (-1.36 to 13.39)  5.7578337 -1.3584923\n124: city_21 12     SO4_MA_07  9.94 (0.33 to 20.46)  9.9379058  0.3315034\n125: city_21 12     NO3_MA_07 20.06 (8.06 to 33.40) 20.0614717  8.0555993\n126: city_21 12     NH4_MA_07 12.56 (2.03 to 24.17) 12.5562146  2.0258434\n      CI_upper      p_value       log_OR  log_OR_se\n  1:  4.550926 0.6723891302  0.007899615 0.01867575\n  2:  1.829751 0.5294120184 -0.008571010 0.01362405\n  3:  2.401534 0.7275376000 -0.005132028 0.01472629\n  4:  6.459253 0.1763879549  0.025560438 0.01889372\n  5:  6.051735 0.4861197066  0.015409127 0.02211619\n ---                                               \n122:  6.816802 0.9050826372  0.003782751 0.03171546\n123: 13.387555 0.1155189939  0.055981707 0.03554069\n124: 20.464089 0.0425078336  0.094745528 0.04665101\n125: 33.401296 0.0006954683  0.182833690 0.05375407\n126: 24.173455 0.0184442512  0.118282596 0.05011563"
  },
  {
    "objectID": "2.ts.html#第二阶段meta分析",
    "href": "2.ts.html#第二阶段meta分析",
    "title": "时间序列研究",
    "section": "第二阶段meta分析",
    "text": "第二阶段meta分析\n\ntidy_rma = function(x, dat){\n  dat %&gt;% \n    .[pm_components == x] %&gt;% \n    .[,metafor::rma(yi = log_OR, sei = log_OR_se)] %&gt;% \n    tidy(conf.int = T, exponentiate = T) %&gt;% \n    mutate(pollut = x, \n           `ER (95% CI)` = glue(\n           \"{formatC((estimate - 1)*100, \n           format = 'f', digits = 2)}% ({formatC((conf.low - 1)*100, \n           format = 'f', digits = 2)} to {formatC((conf.high - 1)*100, \n           format = 'f', digits = 2)}%)\")) %&gt;% \n    dplyr::select(pollut, \n                  `ER (95% CI)`,\n                  OR = estimate, \n                  OR_CI_low = conf.low, \n                  OR_CI_up = conf.high, \n                  p_val = p.value, \n                  se = std.error)\n}\nestimate_meta = map_dfr(pollutant_vec7, tidy_rma, dat = estimate_city)\nestimate_meta\n\n# A tibble: 6 × 7\n  pollut      `ER (95% CI)`             OR OR_CI_low OR_CI_up      p_val      se\n  &lt;chr&gt;       &lt;glue&gt;                 &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;\n1 PM2.5_MA_07 0.94% (0.40 to 1.49%)   1.01     1.00      1.01 0.000710   0.00277\n2 BC_MA_07    0.04% (-0.33 to 0.41%)  1.00     0.997     1.00 0.824      0.00188\n3 OM_MA_07    0.36% (-0.07 to 0.79%)  1.00     0.999     1.01 0.0970     0.00219\n4 SO4_MA_07   1.39% (0.82 to 1.98%)   1.01     1.01      1.02 0.00000216 0.00292\n5 NO3_MA_07   1.41% (0.67 to 2.15%)   1.01     1.01      1.02 0.000177   0.00373\n6 NH4_MA_07   0.97% (0.34 to 1.60%)   1.01     1.00      1.02 0.00239    0.00317\n\n\n结果可视化\n\nestimate_meta %&gt;%\n  mutate(pollutant = gsub('_MA_07', '', pollut)) %&gt;%\n  ggplot(aes(pollutant, OR)) +\n  geom_hline(yintercept = 1, color = 'red', linewidth = 1) +\n  geom_errorbar(aes(ymin = OR_CI_low, ymax = OR_CI_up), width = 0.25) +\n  geom_point(size = 4) +\n  labs(x = 'Pollutants', y = 'OR (95%)') +\n  theme_classic()"
  },
  {
    "objectID": "3.cco.html",
    "href": "3.cco.html",
    "title": "时间分层的病例交叉研究",
    "section": "",
    "text": "Chen, R., Jiang, Y., Hu, J., Chen, H., Li, H., Meng, X., … & Kan, H. (2022). Hourly air pollutants and acute coronary syndrome onset in 1.29 million patients. Circulation (IF=39.9), 145(24), 1749-1760. PDF \nLiu, Y., Pan, J., Fan, C., Xu, R., Wang, Y., Xu, C., … & Zhang, L. (2021). Short-term exposure to ambient air pollution and mortality from myocardial infarction. Journal of the American College of Cardiology (IF=27.2), 77(3), 271-281. PDF \nCai, M., Wei, J., Zhang, S., Liu, W., Wang, L., Qian, Z., Lin, H., Liu, E., McMillin, S.E., Cao, Y., Yin, P. (2023). Short-term air pollution exposure associated with death from kidney diseases: a nationwide time-stratified case-crossover study in China from 2015 to 2019. BMC Medicine (IF=11.8), 21(1), 32. PDF"
  },
  {
    "objectID": "3.cco.html#数据读取",
    "href": "3.cco.html#数据读取",
    "title": "时间分层的病例交叉研究",
    "section": "数据读取",
    "text": "数据读取\n\npacman::p_load(\n  arrow, dplyr, ggplot2, data.table, broom, survival, splines, purrr, latex2exp, patchwork, tableone)\n\ncco_pm = arrow::read_parquet(\n  'Data/cco_synthetic.parquet')\n\nglimpse(cco_pm)\n\nRows: 36,393\nColumns: 13\n$ id                &lt;chr&gt; \"8\", \"8\", \"8\", \"8\", \"18\", \"18\", \"18\", \"18\", \"21\", \"2…\n$ case              &lt;dbl&gt; 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0…\n$ date_control      &lt;date&gt; 2015-07-04, 2015-07-11, 2015-07-18, 2015-07-25, 201…\n$ date_event        &lt;dttm&gt; 2015-07-18, 2015-07-18, 2015-07-18, 2015-07-18, 201…\n$ Temperature_MA_07 &lt;dbl&gt; 25.157479, 26.654723, 27.834193, 26.476728, 5.590609…\n$ RH_MA_07          &lt;dbl&gt; 56.29268, 56.55889, 63.31046, 78.44241, 39.37510, 41…\n$ PM2.5_MA_01       &lt;dbl&gt; 49.64125, 71.13610, 59.45812, 61.66376, 42.55674, 63…\n$ PM2.5_MA_02       &lt;dbl&gt; 51.20873, 69.57587, 61.56069, 61.54747, 51.69360, 72…\n$ PM2.5_MA_03       &lt;dbl&gt; 52.53419, 69.62826, 62.17871, 60.31168, 59.29741, 81…\n$ PM2.5_MA_04       &lt;dbl&gt; 50.22526, 69.04128, 62.92857, 60.95178, 63.24530, 82…\n$ PM2.5_MA_05       &lt;dbl&gt; 50.45423, 67.57404, 64.49090, 61.53650, 65.97250, 85…\n$ PM2.5_MA_06       &lt;dbl&gt; 54.99141, 65.71766, 65.11285, 61.19540, 74.70118, 84…\n$ PM2.5_MA_07       &lt;dbl&gt; 57.36381, 64.22242, 65.32272, 60.85549, 81.05209, 79…\n\ncco_pm\n\n           id case date_control date_event Temperature_MA_07 RH_MA_07\n    1:      8    0   2015-07-04 2015-07-18         25.157479 56.29268\n    2:      8    0   2015-07-11 2015-07-18         26.654723 56.55889\n    3:      8    1   2015-07-18 2015-07-18         27.834193 63.31046\n    4:      8    0   2015-07-25 2015-07-18         26.476728 78.44241\n    5:     18    1   2015-03-04 2015-03-04          5.590609 39.37510\n   ---                                                               \n36389: 101967    0   2019-05-28 2019-05-21         23.694810 43.10004\n36390: 101975    0   2019-10-06 2019-10-27         18.622571 56.82667\n36391: 101975    0   2019-10-13 2019-10-27         15.517046 74.24209\n36392: 101975    0   2019-10-20 2019-10-27         13.168067 62.80148\n36393: 101975    1   2019-10-27 2019-10-27         13.901184 61.54964\n       PM2.5_MA_01 PM2.5_MA_02 PM2.5_MA_03 PM2.5_MA_04 PM2.5_MA_05 PM2.5_MA_06\n    1:    49.64125    51.20873    52.53419    50.22526    50.45423    54.99141\n    2:    71.13610    69.57587    69.62826    69.04128    67.57404    65.71766\n    3:    59.45812    61.56069    62.17871    62.92857    64.49090    65.11285\n    4:    61.66376    61.54747    60.31168    60.95178    61.53650    61.19540\n    5:    42.55674    51.69360    59.29741    63.24530    65.97250    74.70118\n   ---                                                                        \n36389:    24.23324    29.30652    33.04356    33.84328    34.94796    35.59586\n36390:    22.31457    29.18031    32.21481    33.99911    35.63098    37.01669\n36391:    35.99716    34.55549    32.92004    37.70209    39.71017    39.65420\n36392:    78.43440    80.46264    77.49954    73.02039    65.72646    59.30752\n36393:    50.84817    44.64038    54.94739    60.00659    63.58455    65.79182\n       PM2.5_MA_07\n    1:    57.36381\n    2:    64.22242\n    3:    65.32272\n    4:    60.85549\n    5:    81.05209\n   ---            \n36389:    35.43058\n36390:    38.24265\n36391:    38.10932\n36392:    56.35800\n36393:    66.64737"
  },
  {
    "objectID": "3.cco.html#描述性统计",
    "href": "3.cco.html#描述性统计",
    "title": "时间分层的病例交叉研究",
    "section": "描述性统计",
    "text": "描述性统计\n\nvar_vec = c(\"Temperature_MA_07\", \n\"RH_MA_07\", \"PM2.5_MA_01\", \"PM2.5_MA_02\", \"PM2.5_MA_03\", \"PM2.5_MA_04\", \n\"PM2.5_MA_05\", \"PM2.5_MA_06\", \"PM2.5_MA_07\")\n\ntab1 = cco_pm %&gt;% \n  CreateTableOne(\n    vars = var_vec, \n    #factorVars = fact_var,\n    strata = 'case', \n    addOverall = TRUE) %&gt;% \n  print(formatOptions = list(big.mark = \",\"),\n        missing = TRUE,\n        catDigits = 2,\n        contDigits = 2,\n        showAllLevels = TRUE,\n        printToggle = FALSE) %&gt;% \n    as.data.frame() %&gt;% \n    setDT(x = ., keep.rownames = 'variables') %&gt;% \n    dplyr::select(-test)\n\ntab1\n\n                        variables level        Overall              0\n 1:                             n               36,393         28,113\n 2: Temperature_MA_07 (mean (SD))         14.83 (9.82)   14.86 (9.81)\n 3:          RH_MA_07 (mean (SD))        68.83 (15.65)  68.86 (15.64)\n 4:       PM2.5_MA_01 (mean (SD))        44.05 (29.72)  43.95 (29.63)\n 5:       PM2.5_MA_02 (mean (SD))        44.09 (28.82)  44.01 (28.67)\n 6:       PM2.5_MA_03 (mean (SD))        44.11 (28.13)  44.04 (28.02)\n 7:       PM2.5_MA_04 (mean (SD))        44.13 (27.52)  44.05 (27.42)\n 8:       PM2.5_MA_05 (mean (SD))        44.11 (27.01)  44.04 (26.91)\n 9:       PM2.5_MA_06 (mean (SD))        44.09 (26.62)  44.03 (26.52)\n10:       PM2.5_MA_07 (mean (SD))        44.10 (26.31)  44.03 (26.22)\n                1      p Missing\n 1:         8,280               \n 2:  14.73 (9.84)  0.310     0.0\n 3: 68.70 (15.68)  0.391     0.0\n 4: 44.38 (30.03)  0.254     0.0\n 5: 44.36 (29.31)  0.324     0.0\n 6: 44.36 (28.51)  0.367     0.0\n 7: 44.37 (27.87)  0.358     0.0\n 8: 44.35 (27.35)  0.364     0.0\n 9: 44.32 (26.94)  0.375     0.0\n10: 44.31 (26.63)  0.391     0.0"
  },
  {
    "objectID": "3.cco.html#统计建模-条件逻辑回归",
    "href": "3.cco.html#统计建模-条件逻辑回归",
    "title": "时间分层的病例交叉研究",
    "section": "统计建模-条件逻辑回归",
    "text": "统计建模-条件逻辑回归\n\nfit_clogit = function(x, tm_RH_lag = 'MA_07', data = cco_pm){\n  print(glue::glue('\\n----------{x}; {tm_RH_lag}----------\\n'))\n  iqr_x = IQR(data[[x]], na.rm = TRUE)\n  \n  clean_fit = clogit(\n    formula = as.formula(paste0(\"case ~ \", \n                    x, \n                    ' + ns(Temperature_',\n                    tm_RH_lag,\n                    ', df = 5) + ns(RH_',\n                    tm_RH_lag,\n                    ', df = 5)',\n                    ' + strata(id)')),\n    data = data,\n    method = 'approximate') %&gt;% \n    broom::tidy() %&gt;% \n    mutate(OR = exp(estimate*iqr_x), 3,\n           OR_round = round(exp(estimate*iqr_x), 3),\n           CI_low = exp(estimate*iqr_x - 1.96*std.error*iqr_x),\n           CI_high = exp(estimate*iqr_x + 1.96*std.error*iqr_x),\n           CI_low_round = round(exp(estimate*iqr_x - 1.96*std.error*iqr_x), 3),\n           CI_high_round = round(exp(estimate*iqr_x + 1.96*std.error*iqr_x), 3),\n           predictor = x,\n           iqr = iqr_x,\n           tm_RH_lag = tm_RH_lag) %&gt;% \n    mutate(result = paste0(format(OR_round, nsmall = 3), \n                           ' (', \n                           format(CI_low_round, nsmall = 3), \n                           '-', \n                           format(CI_high_round, nsmall = 3),\n                           ')')) %&gt;% \n    filter(predictor == term) %&gt;% \n    mutate(result = gsub('000e\\\\+00| ', '', result)) %&gt;% \n    select(predictor, term, iqr, result, OR, CI_low, CI_high, p.value)\n  \n  return(clean_fit)\n}\n\npm_cols = cco_pm %&gt;% \n  select(starts_with('PM2.5')) %&gt;% \n  names()\n\npm_cols\n\n[1] \"PM2.5_MA_01\" \"PM2.5_MA_02\" \"PM2.5_MA_03\" \"PM2.5_MA_04\" \"PM2.5_MA_05\"\n[6] \"PM2.5_MA_06\" \"PM2.5_MA_07\"\n\n\n\nfit_cco = map_dfr(\n  pm_cols,\n  fit_clogit,\n  data = cco_pm)\n\n----------PM2.5_MA_01; MA_07----------\n----------PM2.5_MA_02; MA_07----------\n----------PM2.5_MA_03; MA_07----------\n----------PM2.5_MA_04; MA_07----------\n----------PM2.5_MA_05; MA_07----------\n----------PM2.5_MA_06; MA_07----------\n----------PM2.5_MA_07; MA_07----------\n\nfit_cco \n\n# A tibble: 7 × 8\n  predictor   term          iqr result                OR CI_low CI_high p.value\n  &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 PM2.5_MA_01 PM2.5_MA_01  29.4 1.023(0.984-1.063)  1.02  0.984    1.06   0.249\n2 PM2.5_MA_02 PM2.5_MA_02  29.2 1.022(0.980-1.065)  1.02  0.980    1.07   0.318\n3 PM2.5_MA_03 PM2.5_MA_03  29.0 1.023(0.978-1.070)  1.02  0.978    1.07   0.324\n4 PM2.5_MA_04 PM2.5_MA_04  28.8 1.029(0.980-1.080)  1.03  0.980    1.08   0.249\n5 PM2.5_MA_05 PM2.5_MA_05  28.7 1.035(0.983-1.090)  1.04  0.983    1.09   0.194\n6 PM2.5_MA_06 PM2.5_MA_06  28.7 1.040(0.983-1.099)  1.04  0.983    1.10   0.172\n7 PM2.5_MA_07 PM2.5_MA_07  28.6 1.042(0.982-1.106)  1.04  0.982    1.11   0.175"
  },
  {
    "objectID": "3.cco.html#暴露反应关系曲线",
    "href": "3.cco.html#暴露反应关系曲线",
    "title": "时间分层的病例交叉研究",
    "section": "暴露反应关系曲线",
    "text": "暴露反应关系曲线\n\ncco_pm[,quantile(PM2.5_MA_01, c(0.25, 0.5, 0.75))]\n\n     25%      50%      75% \n24.85516 36.29862 54.21549 \n\nfit_pm1 = clogit(\n  case ~ ns(PM2.5_MA_01, df = 4, knots = c(24.85516, 36.29862, 54.21549)) + \n    ns(Temperature_MA_07, df = 5) + ns(RH_MA_07, df = 5) + strata(id),\n  data = cco_pm) \n\nsp_pm1 = fit_pm1 %&gt;%\n  termplot(se = T, plot = F) %&gt;%\n  .[['PM2.5_MA_01']] %&gt;%\n  as.data.table() %&gt;% \n  .[,`:=`(HR = exp(y),\n          HRmin = exp(y - 1.96*se),\n          HRmax = exp(y + 1.96*se))] %&gt;% \n  .[, `:=`(pollutant = 'PM2.5')] %&gt;% \n  .[]\n\nsp_pm1\n\n                  x            y        se        HR     HRmin    HRmax\n    1:   0.01227085  0.042335668 0.2042817 1.0432446 0.6990336 1.556948\n    2:   0.01321473  0.042334044 0.2042703 1.0432429 0.6990480 1.556911\n    3:   0.01686711  0.042327760 0.2042264 1.0432364 0.6991039 1.556767\n    4:   0.01824977  0.042325381 0.2042097 1.0432339 0.6991251 1.556713\n    5:   0.03312462  0.042299789 0.2040306 1.0432072 0.6993527 1.556126\n   ---                                                                 \n36342: 364.39734347  0.015824585 0.4892802 1.0159505 0.3893936 2.650673\n36343: 372.32051222  0.006956253 0.5136792 1.0069805 0.3679328 2.755964\n36344: 382.24794690 -0.004490001 0.5447729 0.9955201 0.3422394 2.895810\n36345: 395.03642367 -0.019732329 0.5856061 0.9804611 0.3111375 3.089643\n36346: 482.52457202 -0.133471700 0.8801825 0.8750522 0.1558861 4.912024\n       pollutant\n    1:     PM2.5\n    2:     PM2.5\n    3:     PM2.5\n    4:     PM2.5\n    5:     PM2.5\n   ---          \n36342:     PM2.5\n36343:     PM2.5\n36344:     PM2.5\n36345:     PM2.5\n36346:     PM2.5\n\n\n\narr = list('PM1' = TeX(\"PM$_{1}$\"),  \n           \"PM2.5\" = TeX(\"PM$_{2.5}$\"), \n           \"PM10\" = TeX(\"PM$_{10}$\"))\nmylabel = function(val) { return(lapply(val, function(x) arr[x])) }\ncco_pm[,quantile(PM2.5_MA_01, c(0.01, 0.99))]\n\n        1%        99% \n  7.021625 154.188829 \n\ncolor7 = c('#7570b3', '#d95f02', '#1b9e77')\n\np_pm1 = sp_pm1 %&gt;% \n  .[x &gt;= 7 & x &lt;= 154] %&gt;% \n  .[sample(.N, 1000)] %&gt;% \n  ggplot(aes(x = x, y = HR)) +\n  geom_hline(yintercept = 1, linewidth = 0.8, alpha = 0.6, linetype = 'dashed') +\n  geom_ribbon(aes(ymin = HRmin, ymax = HRmax), alpha = 0.3, color = NA, fill = color7[1]) +\n  geom_line(linewidth = 1.5, color = color7[1]) +\n  facet_wrap(~ pollutant, scales = 'free', labeller = mylabel) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0.05)) +\n  labs(x = NULL, y = 'Odds of death') +\n  theme_test(base_size = 20, base_family = 'serif') + # , base_family = 'serif'\n  theme(plot.margin = unit(c(0, 0.5, 0, 0.2), 'cm'),\n        plot.title = element_text(size = 20, face = 'bold'),\n        strip.background = element_rect(fill = ggplot2::alpha(color7[1], 0.3), color = NA),\n        strip.text = element_text(size = 18, face = 'bold'))\n\np_pm1\n\n\n\n\n\nggsave('cco_splines.pdf', p_pm1, width = 8, height = 6, device = cairo_pdf)"
  },
  {
    "objectID": "4.cross-sec.html",
    "href": "4.cross-sec.html",
    "title": "横截面研究",
    "section": "",
    "text": "Cai, M., Zhang, S., Lin, X., Qian, Z., McMillin, S.E., Yang, Y., Zhang, Z., Pan, J., Lin, H.. (2022) Association of ambient particulate matter pollution of different sizes with in-hospital case fatality among stroke patients in China. Neurology. (IF=12.3) 98(4), e2474-e2486. PDF \nCai, M., Lin, X., Wang, X., Zhang, S., Wang, C., Zhang, Z., Pan, J., Lin, H. (2023). Long-term exposure to ambient fine particulate matter chemical composition and in-hospital case fatality among patients with stroke in China. The Lancet Regional Health-Western Pacific (IF=8.6), 100679. PDF"
  },
  {
    "objectID": "4.cross-sec.html#数据读取",
    "href": "4.cross-sec.html#数据读取",
    "title": "横截面研究",
    "section": "数据读取",
    "text": "数据读取\n\npacman::p_load(\n  arrow, dplyr, ggplot2, data.table, broom, splines, purrr, tableone, patchwork, latex2exp)\n\ncs_pm = arrow::read_parquet(\n  'Data/cs_synthetic_pm_components.parquet')\n\nglimpse(cs_pm)\n\nRows: 30,393\nColumns: 17\n$ inhosp_death      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ age               &lt;int&gt; 61, 68, 69, 74, 71, 52, 74, 72, 77, 66, 60, 73, 60, …\n$ sex               &lt;fct&gt; Female, Female, Male, Male, Female, Male, Male, Male…\n$ ethnicity         &lt;fct&gt; Han, Han, Han, Han, Han, Han, Han, Han, Han, Han, Ha…\n$ occupation        &lt;fct&gt; Farmer, Other, Other, Farmer, Farmer, Other, Farmer,…\n$ marriage          &lt;fct&gt; Married, Married, Married, Married, Married, Other, …\n$ stroke_subtype    &lt;chr&gt; \"Ischemic\", \"Hemorrhagic\", \"Hemorrhagic\", \"Ischemic\"…\n$ hypertension      &lt;dbl&gt; 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1…\n$ diabetes          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0…\n$ Temperature_MA_07 &lt;dbl&gt; 15.405740, 23.771006, -2.423174, 15.489920, 19.48610…\n$ RH_MA_07          &lt;dbl&gt; 84.76136, 69.86074, 58.37018, 77.01996, 75.38288, 67…\n$ PM2.5_MA_365      &lt;dbl&gt; 25.56762, 53.06090, 40.63659, 49.56892, 29.22137, 52…\n$ SO4_MA_365        &lt;dbl&gt; 5.579043, 8.839439, 6.897126, 10.198819, 6.676281, 9…\n$ NO3_MA_365        &lt;dbl&gt; 4.769624, 12.414940, 8.555672, 11.542473, 4.700461, …\n$ NH4_MA_365        &lt;dbl&gt; 4.067301, 7.929543, 5.920617, 8.340625, 4.216512, 8.…\n$ OM_MA_365         &lt;dbl&gt; 7.401939, 11.583662, 9.617350, 12.414788, 8.576074, …\n$ BC_MA_365         &lt;dbl&gt; 1.634150, 2.142325, 2.070287, 2.311701, 2.003598, 2.…"
  },
  {
    "objectID": "4.cross-sec.html#表1制作",
    "href": "4.cross-sec.html#表1制作",
    "title": "横截面研究",
    "section": "表1制作",
    "text": "表1制作\n\nvar_vec = c(\"age\", \"sex\", \"ethnicity\", \"occupation\", \"marriage\", \n\"stroke_subtype\", \"hypertension\", \"diabetes\", \"Temperature_MA_07\", \n\"RH_MA_07\", \"PM2.5_MA_365\", \"SO4_MA_365\", \"NO3_MA_365\", \"NH4_MA_365\", \n\"OM_MA_365\", \"BC_MA_365\")\n\nvar_fct = c(\"sex\", \"ethnicity\", \"occupation\", \"marriage\", \n\"stroke_subtype\", \"hypertension\", \"diabetes\")\n\ntab1 = cs_pm %&gt;% \n  CreateTableOne(\n    vars = var_vec, \n    factorVars = var_fct,\n    strata = 'inhosp_death', \n    addOverall = TRUE) %&gt;% \n  print(formatOptions = list(big.mark = \",\"),\n        missing = TRUE,\n        catDigits = 2,\n        contDigits = 2,\n        showAllLevels = TRUE,\n        printToggle = FALSE) %&gt;% \n    as.data.frame() %&gt;% \n    setDT(x = ., keep.rownames = 'variables') %&gt;% \n    dplyr::select(-test)\n\ntab1\n\n                        variables               level         Overall\n 1:                             n                              30,393\n 2:               age..mean..SD..                        66.39 (7.88)\n 3:                       sex....              Female  13316 (43.81) \n 4:                             X                Male  17077 (56.19) \n 5:                 ethnicity....                 Han  30067 (98.93) \n 6:                           X.1             non-Han    326 ( 1.07) \n 7:                occupation....  Public institution    649 ( 2.14) \n 8:                           X.2 Private institution   1604 ( 5.28) \n 9:                           X.3              Farmer  16603 (54.63) \n10:                           X.4             Jobless    727 ( 2.39) \n11:                           X.5             Retired   3749 (12.34) \n12:                           X.6               Other   7061 (23.23) \n13:                  marriage....             Married  25730 (84.66) \n14:                           X.7           Unmarried    848 ( 2.79) \n15:                           X.8             Widowed   1104 ( 3.63) \n16:                           X.9            Divorced    282 ( 0.93) \n17:                          X.10               Other   2429 ( 7.99) \n18:            stroke_subtype....         Hemorrhagic   7250 (23.85) \n19:                          X.11            Ischemic  21834 (71.84) \n20:                          X.12         Unspecified   1309 ( 4.31) \n21:              hypertension....                   0  14343 (47.19) \n22:                          X.13                   1  16050 (52.81) \n23:                  diabetes....                   0  26129 (85.97) \n24:                          X.14                   1   4264 (14.03) \n25: Temperature_MA_07..mean..SD..                        14.86 (8.99)\n26:          RH_MA_07..mean..SD..                       65.70 (16.23)\n27:      PM2.5_MA_365..mean..SD..                       49.03 (13.13)\n28:        SO4_MA_365..mean..SD..                         8.78 (2.22)\n29:        NO3_MA_365..mean..SD..                        10.68 (2.84)\n30:        NH4_MA_365..mean..SD..                         7.27 (1.74)\n31:         OM_MA_365..mean..SD..                        12.06 (3.12)\n32:         BC_MA_365..mean..SD..                         2.31 (0.63)\n                        variables               level         Overall\n                  0              1      p Missing\n 1:          30,121            272               \n 2:    66.38 (7.87)   67.40 (8.53)  0.034     0.0\n 3:  13213 (43.87)    103 (37.87)   0.054     0.0\n 4:  16908 (56.13)    169 (62.13)                \n 5:  29800 (98.93)    267 (98.16)   0.349     0.0\n 6:    321 ( 1.07)      5 ( 1.84)                \n 7:    647 ( 2.15)      2 ( 0.74)  &lt;0.001     0.0\n 8:   1586 ( 5.27)     18 ( 6.62)                \n 9:  16497 (54.77)    106 (38.97)                \n10:    721 ( 2.39)      6 ( 2.21)                \n11:   3696 (12.27)     53 (19.49)                \n12:   6974 (23.15)     87 (31.99)                \n13:  25514 (84.71)    216 (79.41)  &lt;0.001     0.0\n14:    824 ( 2.74)     24 ( 8.82)                \n15:   1090 ( 3.62)     14 ( 5.15)                \n16:    277 ( 0.92)      5 ( 1.84)                \n17:   2416 ( 8.02)     13 ( 4.78)                \n18:   7086 (23.53)    164 (60.29)  &lt;0.001     0.0\n19:  21746 (72.20)     88 (32.35)                \n20:   1289 ( 4.28)     20 ( 7.35)                \n21:  14206 (47.16)    137 (50.37)   0.321     0.0\n22:  15915 (52.84)    135 (49.63)                \n23:  25910 (86.02)    219 (80.51)   0.012     0.0\n24:   4211 (13.98)     53 (19.49)                \n25:    14.84 (8.99)   16.65 (8.47)  0.001     0.0\n26:   65.66 (16.25)  70.19 (13.59) &lt;0.001     0.0\n27:   49.02 (13.14)  50.28 (12.28)  0.114     0.0\n28:     8.78 (2.22)    9.11 (2.09)  0.014     0.0\n29:    10.68 (2.84)   10.95 (3.00)  0.121     0.0\n30:     7.27 (1.74)    7.45 (1.75)  0.091     0.0\n31:    12.06 (3.13)   12.70 (2.82)  0.001     0.0\n32:     2.31 (0.63)    2.43 (0.55)  0.002     0.0\n                  0              1      p Missing\n\n\n清理结果\n\ntab1_v2 = tab1 %&gt;% \n  mutate(variables = gsub('\\\\.\\\\.\\\\.\\\\.', '', variables, perl = TRUE),\n         variables = fifelse(grepl('X\\\\.', variables, perl = TRUE)|\n                                  variables == 'X', '', variables),\n         variables = gsub('\\\\.\\\\.mean\\\\.\\\\.SD\\\\.\\\\.', ', mean (SD)', \n                             variables, perl = TRUE)) \ntab1_v2\n\n                       variables               level         Overall\n 1:                            n                              30,393\n 2:               age, mean (SD)                        66.39 (7.88)\n 3:                          sex              Female  13316 (43.81) \n 4:                                             Male  17077 (56.19) \n 5:                    ethnicity                 Han  30067 (98.93) \n 6:                                          non-Han    326 ( 1.07) \n 7:                   occupation  Public institution    649 ( 2.14) \n 8:                              Private institution   1604 ( 5.28) \n 9:                                           Farmer  16603 (54.63) \n10:                                          Jobless    727 ( 2.39) \n11:                                          Retired   3749 (12.34) \n12:                                            Other   7061 (23.23) \n13:                     marriage             Married  25730 (84.66) \n14:                                        Unmarried    848 ( 2.79) \n15:                                          Widowed   1104 ( 3.63) \n16:                                         Divorced    282 ( 0.93) \n17:                                            Other   2429 ( 7.99) \n18:               stroke_subtype         Hemorrhagic   7250 (23.85) \n19:                                         Ischemic  21834 (71.84) \n20:                                      Unspecified   1309 ( 4.31) \n21:                 hypertension                   0  14343 (47.19) \n22:                                                1  16050 (52.81) \n23:                     diabetes                   0  26129 (85.97) \n24:                                                1   4264 (14.03) \n25: Temperature_MA_07, mean (SD)                        14.86 (8.99)\n26:          RH_MA_07, mean (SD)                       65.70 (16.23)\n27:      PM2.5_MA_365, mean (SD)                       49.03 (13.13)\n28:        SO4_MA_365, mean (SD)                         8.78 (2.22)\n29:        NO3_MA_365, mean (SD)                        10.68 (2.84)\n30:        NH4_MA_365, mean (SD)                         7.27 (1.74)\n31:         OM_MA_365, mean (SD)                        12.06 (3.12)\n32:         BC_MA_365, mean (SD)                         2.31 (0.63)\n                       variables               level         Overall\n                  0              1      p Missing\n 1:          30,121            272               \n 2:    66.38 (7.87)   67.40 (8.53)  0.034     0.0\n 3:  13213 (43.87)    103 (37.87)   0.054     0.0\n 4:  16908 (56.13)    169 (62.13)                \n 5:  29800 (98.93)    267 (98.16)   0.349     0.0\n 6:    321 ( 1.07)      5 ( 1.84)                \n 7:    647 ( 2.15)      2 ( 0.74)  &lt;0.001     0.0\n 8:   1586 ( 5.27)     18 ( 6.62)                \n 9:  16497 (54.77)    106 (38.97)                \n10:    721 ( 2.39)      6 ( 2.21)                \n11:   3696 (12.27)     53 (19.49)                \n12:   6974 (23.15)     87 (31.99)                \n13:  25514 (84.71)    216 (79.41)  &lt;0.001     0.0\n14:    824 ( 2.74)     24 ( 8.82)                \n15:   1090 ( 3.62)     14 ( 5.15)                \n16:    277 ( 0.92)      5 ( 1.84)                \n17:   2416 ( 8.02)     13 ( 4.78)                \n18:   7086 (23.53)    164 (60.29)  &lt;0.001     0.0\n19:  21746 (72.20)     88 (32.35)                \n20:   1289 ( 4.28)     20 ( 7.35)                \n21:  14206 (47.16)    137 (50.37)   0.321     0.0\n22:  15915 (52.84)    135 (49.63)                \n23:  25910 (86.02)    219 (80.51)   0.012     0.0\n24:   4211 (13.98)     53 (19.49)                \n25:    14.84 (8.99)   16.65 (8.47)  0.001     0.0\n26:   65.66 (16.25)  70.19 (13.59) &lt;0.001     0.0\n27:   49.02 (13.14)  50.28 (12.28)  0.114     0.0\n28:     8.78 (2.22)    9.11 (2.09)  0.014     0.0\n29:    10.68 (2.84)   10.95 (3.00)  0.121     0.0\n30:     7.27 (1.74)    7.45 (1.75)  0.091     0.0\n31:    12.06 (3.13)   12.70 (2.82)  0.001     0.0\n32:     2.31 (0.63)    2.43 (0.55)  0.002     0.0\n                  0              1      p Missing\n\n\n每3位数字加上逗号\n\nadd_comma = function(x, separator = ','){\n  str_pattern = '(\\\\d+|\\\\d+\\\\.\\\\d+)(\\\\s+\\\\((\\\\s+|)(\\\\d+| \\\\d+)\\\\.\\\\d+\\\\))'\n  d_numb = gsub('^\\\\s+|^\\\\s+$', '', x) %&gt;% \n    gsub(str_pattern, '\\\\1', .) %&gt;% \n    as.numeric() %&gt;% \n    suppressWarnings() %&gt;% \n    scales::label_comma(\n      accuracy = 0.01, \n      decimal.mark = \".\", \n      big.mark = separator)(.)\n  d_perc = gsub(str_pattern, '\\\\2', x)\n  \n  return_vec = ifelse(\n    grepl('(\\\\d+)( \\\\()((\\\\d+| \\\\d+)\\\\.\\\\d+)(\\\\))', x),\n    paste0(d_numb, d_perc) %&gt;% \n      gsub('\\\\.00', '', .) %&gt;% \n      gsub('\\\\s+\\\\(', ' \\\\(', .),\n    x)\n  \n  return(return_vec)\n}\n\ntab1_v3 = tab1_v2 %&gt;% \n  mutate(across(Overall:`1`, add_comma))\n\ntab1_v3\n\n                       variables               level         Overall\n 1:                            n                              30,393\n 2:               age, mean (SD)                        66.39 (7.88)\n 3:                          sex              Female 13,316 (43.81) \n 4:                                             Male 17,077 (56.19) \n 5:                    ethnicity                 Han 30,067 (98.93) \n 6:                                          non-Han    326 ( 1.07) \n 7:                   occupation  Public institution    649 ( 2.14) \n 8:                              Private institution  1,604 ( 5.28) \n 9:                                           Farmer 16,603 (54.63) \n10:                                          Jobless    727 ( 2.39) \n11:                                          Retired  3,749 (12.34) \n12:                                            Other  7,061 (23.23) \n13:                     marriage             Married 25,730 (84.66) \n14:                                        Unmarried    848 ( 2.79) \n15:                                          Widowed  1,104 ( 3.63) \n16:                                         Divorced    282 ( 0.93) \n17:                                            Other  2,429 ( 7.99) \n18:               stroke_subtype         Hemorrhagic  7,250 (23.85) \n19:                                         Ischemic 21,834 (71.84) \n20:                                      Unspecified  1,309 ( 4.31) \n21:                 hypertension                   0 14,343 (47.19) \n22:                                                1 16,050 (52.81) \n23:                     diabetes                   0 26,129 (85.97) \n24:                                                1  4,264 (14.03) \n25: Temperature_MA_07, mean (SD)                        14.86 (8.99)\n26:          RH_MA_07, mean (SD)                       65.70 (16.23)\n27:      PM2.5_MA_365, mean (SD)                       49.03 (13.13)\n28:        SO4_MA_365, mean (SD)                         8.78 (2.22)\n29:        NO3_MA_365, mean (SD)                        10.68 (2.84)\n30:        NH4_MA_365, mean (SD)                         7.27 (1.74)\n31:         OM_MA_365, mean (SD)                        12.06 (3.12)\n32:         BC_MA_365, mean (SD)                         2.31 (0.63)\n                       variables               level         Overall\n                  0             1      p Missing\n 1:          30,121           272               \n 2:    66.38 (7.87)  67.40 (8.53)  0.034     0.0\n 3: 13,213 (43.87)   103 (37.87)   0.054     0.0\n 4: 16,908 (56.13)   169 (62.13)                \n 5: 29,800 (98.93)   267 (98.16)   0.349     0.0\n 6:    321 ( 1.07)     5 ( 1.84)                \n 7:    647 ( 2.15)     2 ( 0.74)  &lt;0.001     0.0\n 8:  1,586 ( 5.27)    18 ( 6.62)                \n 9: 16,497 (54.77)   106 (38.97)                \n10:    721 ( 2.39)     6 ( 2.21)                \n11:  3,696 (12.27)    53 (19.49)                \n12:  6,974 (23.15)    87 (31.99)                \n13: 25,514 (84.71)   216 (79.41)  &lt;0.001     0.0\n14:    824 ( 2.74)    24 ( 8.82)                \n15:  1,090 ( 3.62)    14 ( 5.15)                \n16:    277 ( 0.92)     5 ( 1.84)                \n17:  2,416 ( 8.02)    13 ( 4.78)                \n18:  7,086 (23.53)   164 (60.29)  &lt;0.001     0.0\n19: 21,746 (72.20)    88 (32.35)                \n20:  1,289 ( 4.28)    20 ( 7.35)                \n21: 14,206 (47.16)   137 (50.37)   0.321     0.0\n22: 15,915 (52.84)   135 (49.63)                \n23: 25,910 (86.02)   219 (80.51)   0.012     0.0\n24:  4,211 (13.98)    53 (19.49)                \n25:    14.84 (8.99)  16.65 (8.47)  0.001     0.0\n26:   65.66 (16.25) 70.19 (13.59) &lt;0.001     0.0\n27:   49.02 (13.14) 50.28 (12.28)  0.114     0.0\n28:     8.78 (2.22)   9.11 (2.09)  0.014     0.0\n29:    10.68 (2.84)     10.95 (3)  0.121     0.0\n30:     7.27 (1.74)   7.45 (1.75)  0.091     0.0\n31:    12.06 (3.13)  12.70 (2.82)  0.001     0.0\n32:     2.31 (0.63)   2.43 (0.55)  0.002     0.0\n                  0             1      p Missing\n\n\n写出成excel进行整理\n\nfwrite(tab1_v3, 'tab1.csv')\ngetwd()"
  },
  {
    "objectID": "4.cross-sec.html#逻辑回归",
    "href": "4.cross-sec.html#逻辑回归",
    "title": "横截面研究",
    "section": "逻辑回归",
    "text": "逻辑回归\n\nfit_logistic = function(x, data = cs_pm, outcome_var = 'inhosp_death'){\n  cat(paste0(x, '\\n'))\n  x_iqr = IQR(data[[x]], na.rm = TRUE)\n  \n  clean_fit = glm(\n    formula = as.formula(paste0(outcome_var, \" ~ \", \n                    x, \n                    ' + age + sex + ethnicity + occupation + marriage + stroke_subtype + \n                    hypertension + diabetes + \n                    ns(Temperature_MA_07 , df = 5) + ns(RH_MA_07, df = 5)')),\n    family = binomial, #Logistic regression设置连接函数\n    data = data) %&gt;% \n    tidy() %&gt;% \n    #filter(grepl('PM|O3|CO|NO2|SO2', term)) %&gt;% \n    mutate(OR = exp(estimate*x_iqr), 3,\n           OR_round = round(exp(estimate*x_iqr), 3),\n           CI_low = exp(estimate*x_iqr - 1.96*std.error*x_iqr),\n           CI_high = exp(estimate*x_iqr + 1.96*std.error*x_iqr),\n           CI_low_round = round(exp(estimate*x_iqr - 1.96*std.error*x_iqr), 3),\n           CI_high_round = round(exp(estimate*x_iqr + 1.96*std.error*x_iqr), 3),\n           predictor = x) %&gt;% \n    mutate(result = paste0(format(OR_round, nsmall = 3), \n                           ' (', \n                           format(CI_low_round, nsmall = 3), \n                           '-', \n                           format(CI_high_round, nsmall = 3),\n                           ')') %&gt;% \n             gsub(' ', '', .) %&gt;% \n             gsub('\\\\(', ' (', .),\n           pollutant_IQR = x_iqr) %&gt;% \n    mutate(result = gsub('000e\\\\+00', '', result)) %&gt;% \n    select(predictor, term, pollutant_IQR, result, OR, CI_low, CI_high, p.value)\n  \n  return(clean_fit)\n}\n\nfit_longterm_365 = purrr::map_df(\n  c(\"PM2.5_MA_365\", \"SO4_MA_365\", \"NO3_MA_365\", \n    \"NH4_MA_365\", \"OM_MA_365\", \"BC_MA_365\"), \n  fit_logistic,\n  data = cs_pm)\n\nPM2.5_MA_365\nSO4_MA_365\nNO3_MA_365\nNH4_MA_365\nOM_MA_365\nBC_MA_365\n\nfit_longterm_365 %&gt;% \n  filter(predictor == term)\n\n# A tibble: 6 × 8\n  predictor    term         pollutant_IQR result       OR CI_low CI_high p.value\n  &lt;chr&gt;        &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 PM2.5_MA_365 PM2.5_MA_365        15.1   1.142 (0…  1.14  0.978    1.33 0.0939 \n2 SO4_MA_365   SO4_MA_365           2.83  1.172 (0…  1.17  0.997    1.38 0.0551 \n3 NO3_MA_365   NO3_MA_365           3.28  1.133 (0…  1.13  0.972    1.32 0.111  \n4 NH4_MA_365   NH4_MA_365           2.00  1.116 (0…  1.12  0.961    1.30 0.150  \n5 OM_MA_365    OM_MA_365            3.47  1.218 (1…  1.22  1.05     1.41 0.00732\n6 BC_MA_365    BC_MA_365            0.712 1.197 (1…  1.20  1.04     1.38 0.0143"
  },
  {
    "objectID": "4.cross-sec.html#暴露反应关系",
    "href": "4.cross-sec.html#暴露反应关系",
    "title": "横截面研究",
    "section": "暴露反应关系",
    "text": "暴露反应关系\n\nquantile(cs_pm$PM2.5_MA_365, c(0.25, 0.5, 0.75))\n\n     25%      50%      75% \n40.48217 47.54928 55.58546 \n\nquantile(cs_pm$PM2.5_MA_365, c(0.01, 0.99))\n\n      1%      99% \n21.38067 85.20396 \n\nfit_pm2.5 = glm(\n  inhosp_death ~ ns(PM2.5_MA_365, knots = c(40.48, 65.54, 75.58)) + \n    age + sex + ethnicity + occupation + marriage + stroke_subtype,\n  family = binomial,\n  data = cs_pm %&gt;% \n    filter(PM2.5_MA_365 &gt; 21.38 & PM2.5_MA_365 &lt; 80)) \n\nsp_pm2.5 = fit_pm2.5 %&gt;%\n  termplot(se = T, plot = F) %&gt;%\n  .[['PM2.5_MA_365']] %&gt;%\n  as.data.table() %&gt;% \n  .[,`:=`(HR = exp(y),\n          HRmin = exp(y - 1.96*se),\n          HRmax = exp(y + 1.96*se))] %&gt;% \n  .[, `:=`(pollutant = 'PM2.5')] %&gt;% \n  .[]\n\nsp_pm2.5\n\n              x          y        se        HR     HRmin    HRmax pollutant\n    1: 21.38206 -0.1801450 0.4066939 0.8351491 0.3763390 1.853313     PM2.5\n    2: 21.38321 -0.1801495 0.4066593 0.8351453 0.3763627 1.853179     PM2.5\n    3: 21.38823 -0.1801692 0.4065088 0.8351289 0.3764664 1.852596     PM2.5\n    4: 21.39237 -0.1801854 0.4063849 0.8351154 0.3765517 1.852116     PM2.5\n    5: 21.39479 -0.1801949 0.4063122 0.8351074 0.3766018 1.851835     PM2.5\n   ---                                                                     \n29033: 79.90769 -0.4279915 0.7258555 0.6518169 0.1571321 2.703873     PM2.5\n29034: 79.91672 -0.4278512 0.7271430 0.6519084 0.1567581 2.711085     PM2.5\n29035: 79.94468 -0.4274167 0.7311304 0.6521917 0.1556054 2.733544     PM2.5\n29036: 79.97850 -0.4268909 0.7359584 0.6525347 0.1542209 2.760985     PM2.5\n29037: 79.99940 -0.4265660 0.7389445 0.6527468 0.1533707 2.778095     PM2.5\n\n\n\narr = list('PM1' = TeX(\"PM$_{1}$\"),  \n           \"PM2.5\" = TeX(\"PM$_{2.5}$\"), \n           \"PM10\" = TeX(\"PM$_{10}$\"))\nmylabel = function(val) { return(lapply(val, function(x) arr[x])) }\n\ncolor7 = c('#7570b3', '#d95f02', '#1b9e77')\n\np_pm2.5 = sp_pm2.5 %&gt;% \n  ggplot(aes(x = x, y = HR)) +\n  geom_hline(yintercept = 1, linewidth = 0.8, alpha = 0.6, linetype = 'dashed') +\n  geom_ribbon(aes(ymin = HRmin, ymax = HRmax), alpha = 0.3, color = NA, fill = color7[1]) +\n  geom_line(linewidth = 1.5, color = color7[1]) +\n  facet_wrap(~ pollutant, scales = 'free', labeller = mylabel) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0.05)) +\n  labs(x = NULL, y = 'Odds of death') +\n  theme_test(base_size = 20, base_family = 'serif') + # , base_family = 'serif'\n  theme(plot.margin = unit(c(0, 0.5, 0, 0.2), 'cm'),\n        plot.title = element_text(size = 20, face = 'bold'),\n        strip.background = element_rect(fill = ggplot2::alpha(color7[1], 0.3), color = NA),\n        strip.text = element_text(size = 18, face = 'bold'))\n\np_pm2.5"
  },
  {
    "objectID": "5.cohort.html",
    "href": "5.cohort.html",
    "title": "队列研究",
    "section": "",
    "text": "Di, Q., Wang, Y., Zanobetti, A., Wang, Y., Koutrakis, P., Choirat, C., … Schwartz, J. D. (2017). Air pollution and mortality in the Medicare population. New England Journal of Medicine (IF=176), 376(26), 2513-2522. PDF  DOI: 10.1056/NEJMoa1702747\nYu, K., Qiu, G., Chan, K. H., Lam, K. B. H., Kurmi, O. P., Bennett, D. A., … Wu, T. (2018). Association of solid fuel use with risk of cardiovascular and all-cause mortality in rural China. JAMA (IF=157), 319(13), 1351-1361. PDF  DOI: https://doi.org/10.1001/jama.2018.2151\nCai, M., Li, H., Wu, Y., Zhang. S., Wang. X., Zhang. Z., Lin. H. (2022) Ambient Air Pollution Associated with Body Fat Percentages at Different Body Compartments: A Cohort Study of UK Biobank Participants. Environmental Health Perspectives (IF=11.0). 130(6): 067702. PDF \nCai, M., Lin, X., Wang, X., Zhang, S., Qian, Z., McMillin, S.E., Aaron, H.E., Lin, H., Wei, J., Zhang, Z., Pan, J. (2022) Ambient particulate matter pollution of different sizes associated with recurrent stroke hospitalization in China: a cohort study of 1.07 million stroke patients. Science of the Total Environment (IF=10.8). 159104. PDF"
  },
  {
    "objectID": "5.cohort.html#cox回归",
    "href": "5.cohort.html#cox回归",
    "title": "队列研究",
    "section": "Cox回归",
    "text": "Cox回归\n\n读取数据\n\npacman::p_load(\n  arrow, dplyr, ggplot2, data.table, broom, survival, splines, survival, purrr, latex2exp, patchwork, rms)\n\ncohort_cox = arrow::read_parquet(\n  'Data/cohort_Cox_synthetic.parquet')\n\nglimpse(cohort_cox)\n\nRows: 8,262\nColumns: 12\n$ rehosp_staus      &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0…\n$ t2rehosp          &lt;int&gt; 741, 1267, 510, 126, 1076, 402, 980, 589, 502, 524, …\n$ age               &lt;dbl&gt; 74, 79, 72, 79, 52, 75, 68, 62, 75, 73, 77, 70, 76, …\n$ sex               &lt;fct&gt; Female, Female, Female, Female, Female, Female, Fema…\n$ ethnicity         &lt;fct&gt; Han, Han, Han, Han, Han, Han, Han, Han, Han, Han, Ha…\n$ marriage          &lt;fct&gt; Married, Married, Married, Married, Married, Married…\n$ occupation        &lt;fct&gt; Farmer, Farmer, Other, Other, Other, Farmer, Other, …\n$ PM1_MA_365        &lt;dbl&gt; 26.94837, 21.58845, 26.15891, 25.80991, 34.91308, 36…\n$ PM2.5_MA_365      &lt;dbl&gt; 41.79592, 31.49986, 36.12802, 42.01941, 48.28277, 44…\n$ PM10_MA_365       &lt;dbl&gt; 68.51770, 63.77828, 57.15183, 67.48609, 76.22407, 72…\n$ Temperature_MA_07 &lt;dbl&gt; 5.847840, 24.166486, 26.243227, 9.688386, 6.529096, …\n$ RH_MA_07          &lt;dbl&gt; 73.08185, 67.75124, 87.87124, 72.36949, 68.59028, 71…\n\n\n\n\n拟合模型\n\nfit0 = coxph(\n    formula = Surv(t2rehosp, rehosp_staus) ~ PM1_MA_365 + age + ethnicity + \n      marriage + occupation + ns(Temperature_MA_07, df = 5) + ns(RH_MA_07, df = 5), \n    data = cohort_cox)\n\nclass(fit0)\n\n[1] \"coxph\"\n\nfit0\n\nCall:\ncoxph(formula = Surv(t2rehosp, rehosp_staus) ~ PM1_MA_365 + age + \n    ethnicity + marriage + occupation + ns(Temperature_MA_07, \n    df = 5) + ns(RH_MA_07, df = 5), data = cohort_cox)\n\n                                    coef exp(coef)  se(coef)      z       p\nPM1_MA_365                      0.011054  1.011115  0.003903  2.832 0.00462\nage                            -0.001324  0.998677  0.002192 -0.604 0.54576\nethnicityNon-han               -0.058235  0.943428  0.201408 -0.289 0.77247\nmarriageUnmarried               0.186563  1.205100  0.104045  1.793 0.07296\nmarriageWidowed                 0.038527  1.039279  0.096506  0.399 0.68973\nmarriageDivorced                0.207441  1.230525  0.159879  1.297 0.19446\nmarriageOther                  -0.118606  0.888158  0.158128 -0.750 0.45322\noccupationPrivate institution  -0.134948  0.873761  0.151888 -0.888 0.37429\noccupationFarmer               -0.101090  0.903852  0.128781 -0.785 0.43247\noccupationJobless              -0.149602  0.861050  0.177534 -0.843 0.39942\noccupationRetired              -0.101371  0.903598  0.143299 -0.707 0.47931\noccupationOther                -0.241753  0.785250  0.131212 -1.842 0.06541\nns(Temperature_MA_07, df = 5)1  0.010090  1.010141  0.762198  0.013 0.98944\nns(Temperature_MA_07, df = 5)2  0.036154  1.036816  0.810714  0.045 0.96443\nns(Temperature_MA_07, df = 5)3 -0.044010  0.956944  0.474768 -0.093 0.92614\nns(Temperature_MA_07, df = 5)4  0.292356  1.339580  1.608833  0.182 0.85580\nns(Temperature_MA_07, df = 5)5 -0.025618  0.974708  0.371333 -0.069 0.94500\nns(RH_MA_07, df = 5)1           0.419264  1.520842  0.664890  0.631 0.52832\nns(RH_MA_07, df = 5)2           0.450642  1.569319  0.691113  0.652 0.51437\nns(RH_MA_07, df = 5)3           0.077616  1.080708  0.392458  0.198 0.84323\nns(RH_MA_07, df = 5)4           0.620296  1.859479  1.408819  0.440 0.65972\nns(RH_MA_07, df = 5)5           0.194996  1.215307  0.419406  0.465 0.64198\n\nLikelihood ratio test=34.99  on 22 df, p=0.03881\nn= 8262, number of events= 2474 \n\n\n\n# 提取结果成数据框，方便导出excel\nfit0 %&gt;% \n  tidy()\n\n# A tibble: 22 × 5\n   term                          estimate std.error statistic p.value\n   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n 1 PM1_MA_365                     0.0111    0.00390     2.83  0.00462\n 2 age                           -0.00132   0.00219    -0.604 0.546  \n 3 ethnicityNon-han              -0.0582    0.201      -0.289 0.772  \n 4 marriageUnmarried              0.187     0.104       1.79  0.0730 \n 5 marriageWidowed                0.0385    0.0965      0.399 0.690  \n 6 marriageDivorced               0.207     0.160       1.30  0.194  \n 7 marriageOther                 -0.119     0.158      -0.750 0.453  \n 8 occupationPrivate institution -0.135     0.152      -0.888 0.374  \n 9 occupationFarmer              -0.101     0.129      -0.785 0.432  \n10 occupationJobless             -0.150     0.178      -0.843 0.399  \n# ℹ 12 more rows\n\n\n\n# 提取结果为exp后的HR值，而非线性项的值\nfit0 %&gt;% \n  tidy(exponentiate = TRUE)\n\n# A tibble: 22 × 5\n   term                          estimate std.error statistic p.value\n   &lt;chr&gt;                            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n 1 PM1_MA_365                       1.01    0.00390     2.83  0.00462\n 2 age                              0.999   0.00219    -0.604 0.546  \n 3 ethnicityNon-han                 0.943   0.201      -0.289 0.772  \n 4 marriageUnmarried                1.21    0.104       1.79  0.0730 \n 5 marriageWidowed                  1.04    0.0965      0.399 0.690  \n 6 marriageDivorced                 1.23    0.160       1.30  0.194  \n 7 marriageOther                    0.888   0.158      -0.750 0.453  \n 8 occupationPrivate institution    0.874   0.152      -0.888 0.374  \n 9 occupationFarmer                 0.904   0.129      -0.785 0.432  \n10 occupationJobless                0.861   0.178      -0.843 0.399  \n# ℹ 12 more rows\n\n\n\n# 提取结果为exp后的HR值，而非线性项的值\nfit0 %&gt;% \n  tidy(exponentiate = TRUE, conf.int = T, conf.level = 0.95)\n\n# A tibble: 22 × 7\n   term                  estimate std.error statistic p.value conf.low conf.high\n   &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 PM1_MA_365               1.01    0.00390     2.83  0.00462    1.00       1.02\n 2 age                      0.999   0.00219    -0.604 0.546      0.994      1.00\n 3 ethnicityNon-han         0.943   0.201      -0.289 0.772      0.636      1.40\n 4 marriageUnmarried        1.21    0.104       1.79  0.0730     0.983      1.48\n 5 marriageWidowed          1.04    0.0965      0.399 0.690      0.860      1.26\n 6 marriageDivorced         1.23    0.160       1.30  0.194      0.900      1.68\n 7 marriageOther            0.888   0.158      -0.750 0.453      0.651      1.21\n 8 occupationPrivate in…    0.874   0.152      -0.888 0.374      0.649      1.18\n 9 occupationFarmer         0.904   0.129      -0.785 0.432      0.702      1.16\n10 occupationJobless        0.861   0.178      -0.843 0.399      0.608      1.22\n# ℹ 12 more rows\n\n\n\nfit_cox = function(x, dat = drehosp, scale_num = 10){\n  clean_fit = coxph(\n    formula = as.formula(paste0(\"Surv(t2rehosp, rehosp_staus) ~ \", \n                    x, \n                    ' + age + ethnicity + marriage + occupation + \n                    ns(Temperature_MA_07, df = 5) + ns(RH_MA_07, df = 5)')), \n    data = dat) %&gt;% \n    tidy() %&gt;% \n    filter(grepl('PM|O3|CO|NO2|SO2', term)) %&gt;% \n    mutate(OR = exp(estimate*scale_num), 3,\n           OR_round = round(exp(estimate*scale_num), 3),\n           CI_low = exp(estimate*scale_num - 1.96*std.error*scale_num),\n           CI_high = exp(estimate*scale_num + 1.96*std.error*scale_num),\n           CI_low_round = round(exp(estimate*scale_num - 1.96*std.error*scale_num), 3),\n           CI_high_round = round(exp(estimate*scale_num + 1.96*std.error*scale_num), 3),\n           predictor = x) %&gt;% \n    mutate(result = paste0(format(OR_round, nsmall = 3), \n                           ' (', \n                           format(CI_low_round, nsmall = 3), \n                           '-', \n                           format(CI_high_round, nsmall = 3),\n                           ')')) %&gt;% \n    select(predictor, term, result, OR, CI_low, CI_high, p.value) \n  \n  print(x)\n  \n  return(clean_fit)\n}\n\nestimate_cox = map_dfr(\n     c(\"PM1_MA_365\", \"PM2.5_MA_365\", \"PM10_MA_365\"), \n     fit_cox, \n     dat = cohort_cox,\n     scale_num = 10)\n\n[1] \"PM1_MA_365\"\n[1] \"PM2.5_MA_365\"\n[1] \"PM10_MA_365\"\n\nestimate_cox\n\n# A tibble: 3 × 7\n  predictor    term         result                 OR CI_low CI_high     p.value\n  &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;               &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;\n1 PM1_MA_365   PM1_MA_365   1.117 (1.035-1.206)  1.12   1.03    1.21     4.62e-3\n2 PM2.5_MA_365 PM2.5_MA_365 1.112 (1.062-1.165)  1.11   1.06    1.17     7.28e-6\n3 PM10_MA_365  PM10_MA_365  1.098 (1.061-1.136)  1.10   1.06    1.14     6.20e-8\n\n\n\n\n暴露反应关系\n\nquantile(cohort_cox$PM2.5_MA_365, c(0.25, 0.5, 0.75))\n\n     25%      50%      75% \n38.12038 42.49512 48.53397 \n\nquantile(cohort_cox$PM2.5_MA_365, c(0.01, 0.99))\n\n      1%      99% \n21.55512 67.39910 \n\nfit_cox_pm2.5 = coxph(\n  Surv(t2rehosp, rehosp_staus) ~ ns(PM2.5_MA_365, knots = c(40.48, 60, 63)) + \n    age + ethnicity + marriage + occupation + ns(Temperature_MA_07, df = 5) + ns(RH_MA_07, df = 5),\n  data = cohort_cox %&gt;% \n    filter(PM2.5_MA_365 &gt; 21.55 & PM2.5_MA_365 &lt; 67)) \n\nsp_cox_pm2.5 = fit_cox_pm2.5 %&gt;%\n  termplot(se = T, plot = F) %&gt;%\n  .[['PM2.5_MA_365']] %&gt;%\n  as.data.table() %&gt;% \n  .[,`:=`(HR = exp(y),\n          HRmin = exp(y - 1.96*se),\n          HRmax = exp(y + 1.96*se))] %&gt;% \n  .[, `:=`(pollutant = 'PM2.5')] %&gt;% \n  .[]\n\nsp_cox_pm2.5\n\n             x          y        se        HR     HRmin     HRmax pollutant\n   1: 21.57385 -0.3434542 0.1633379 0.7093160 0.5149958 0.9769578     PM2.5\n   2: 21.57581 -0.3434234 0.1633122 0.7093378 0.5150376 0.9769386     PM2.5\n   3: 21.60621 -0.3429450 0.1629124 0.7096772 0.5156881 0.9766404     PM2.5\n   4: 21.73148 -0.3409740 0.1612655 0.7110774 0.5183760 0.9754136     PM2.5\n   5: 21.77162 -0.3403425 0.1607381 0.7115266 0.5192400 0.9750213     PM2.5\n  ---                                                                      \n8048: 66.53952  0.1896596 0.2733318 1.2088381 0.7074625 2.0655364     PM2.5\n8049: 66.64180  0.1940871 0.2833337 1.2142020 0.6968069 2.1157749     PM2.5\n8050: 66.73012  0.1979229 0.2920360 1.2188684 0.6876552 2.1604434     PM2.5\n8051: 66.93246  0.2067362 0.3121532 1.2296581 0.6669207 2.2672248     PM2.5\n8052: 66.95539  0.2077358 0.3144453 1.2308879 0.6645953 2.2797108     PM2.5\n\n\n\narr = list('PM1' = TeX(\"PM$_{1}$\"),  \n           \"PM2.5\" = TeX(\"PM$_{2.5}$\"), \n           \"PM10\" = TeX(\"PM$_{10}$\"))\nmylabel = function(val) { return(lapply(val, function(x) arr[x])) }\n\ncolor7 = c('#7570b3', '#d95f02', '#1b9e77')\n\np_cox_pm2.5 = sp_cox_pm2.5 %&gt;% \n  ggplot(aes(x = x, y = HR)) +\n  geom_hline(yintercept = 1, linewidth = 0.8, alpha = 0.6, linetype = 'dashed') +\n  geom_ribbon(aes(ymin = HRmin, ymax = HRmax), alpha = 0.3, color = NA, fill = color7[1]) +\n  geom_line(linewidth = 1.5, color = color7[1]) +\n  facet_wrap(~ pollutant, scales = 'free', labeller = mylabel) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0.05)) +\n  labs(x = NULL, y = 'Hazard of death') +\n  theme_test(base_size = 20, base_family = 'serif') + # , base_family = 'serif'\n  theme(plot.margin = unit(c(0, 0.5, 0, 0.2), 'cm'),\n        plot.title = element_text(size = 20, face = 'bold'),\n        strip.background = element_rect(fill = ggplot2::alpha(color7[1], 0.3), color = NA),\n        strip.text = element_text(size = 18, face = 'bold'))\n\np_cox_pm2.5\n\n\n\n\n可以尝试调节不同节点和不同df对曲线的影响。\n\n\n多个图形进行拼图\n先拟合一个PM\\(_1\\)的图形：\n\nquantile(cohort_cox$PM10_MA_365, c(0.25, 0.5, 0.75))\n\n     25%      50%      75% \n61.18076 69.45975 77.40257 \n\nquantile(cohort_cox$PM10_MA_365, c(0.01, 0.99))\n\n       1%       99% \n 39.12063 105.25648 \n\nfit_cox_pm10 = coxph(\n  Surv(t2rehosp, rehosp_staus) ~ ns(PM10_MA_365, knots = c(40.48, 80, 90)) + \n    age + ethnicity + marriage + occupation + ns(Temperature_MA_07, df = 5) + ns(RH_MA_07, df = 5),\n  data = cohort_cox %&gt;% \n    filter(PM10_MA_365 &gt; 40 & PM10_MA_365 &lt; 105)) \n\nsp_cox_pm10 = fit_cox_pm10 %&gt;%\n  termplot(se = T, plot = F) %&gt;%\n  .[['PM10_MA_365']] %&gt;%\n  as.data.table() %&gt;% \n  .[,`:=`(HR = exp(y),\n          HRmin = exp(y - 1.96*se),\n          HRmax = exp(y + 1.96*se))] %&gt;% \n  .[, `:=`(pollutant = 'PM10')] %&gt;% \n  .[]\n\np_cox_pm10 = sp_cox_pm10 %&gt;% \n  ggplot(aes(x = x, y = HR)) +\n  geom_hline(yintercept = 1, linewidth = 0.8, alpha = 0.6, linetype = 'dashed') +\n  geom_ribbon(aes(ymin = HRmin, ymax = HRmax), alpha = 0.3, color = NA, fill = color7[2]) +\n  geom_line(linewidth = 1.5, color = color7[2]) +\n  facet_wrap(~ pollutant, scales = 'free', labeller = mylabel) +\n  scale_x_continuous(expand = c(0, 0)) +\n  scale_y_continuous(expand = c(0, 0.05)) +\n  labs(x = NULL, y = 'Hazard of death') +\n  theme_test(base_size = 20, base_family = 'serif') + # , base_family = 'serif'\n  theme(plot.margin = unit(c(0, 0.5, 0, 0.2), 'cm'),\n        plot.title = element_text(size = 20, face = 'bold'),\n        strip.background = element_rect(fill = ggplot2::alpha(color7[2], 0.3), color = NA),\n        strip.text = element_text(size = 18, face = 'bold'))\n\np_cox_pm10\n\n\n\n\n使用patchwork包进行拼图\n\np_cox_pm2.5|p_cox_pm10\n\n\n\n\n\np_cox_pm2.5/p_cox_pm10\n\n\n\n\n\n\n限制性立方样条\n\nrcs_cox_pm2.5 &lt;- cph(Surv(t2rehosp, rehosp_staus) ~ rcs(PM2.5_MA_365, c(40.48, 60, 63)) + age + ethnicity + marriage + occupation + rcs(Temperature_MA_07, df = 5), \n                     data = cohort_cox %&gt;% \n    filter(PM2.5_MA_365 &gt; 21.55 & PM2.5_MA_365 &lt; 67))\n\nanova(rcs_cox_pm2.5)\n\n                Wald Statistics          Response: Surv(t2rehosp, rehosp_staus) \n\n Factor            Chi-Square d.f. P     \n PM2.5_MA_365      26.36       2   &lt;.0001\n  Nonlinear         3.44       1   0.0637\n age                0.62       1   0.4327\n ethnicity          0.00       1   0.9448\n marriage           5.03       4   0.2839\n occupation        12.64       5   0.0270\n Temperature_MA_07  4.29       4   0.3682\n  Nonlinear         1.92       3   0.5894\n TOTAL NONLINEAR    5.21       4   0.2661\n TOTAL             44.41      17   0.0003\n\ndd &lt;- datadist(cohort_cox %&gt;% \n    filter(PM2.5_MA_365 &gt; 21.55 & PM2.5_MA_365 &lt; 67))\noptions(datadist = 'dd')\nHR &lt;- Predict(rcs_cox_pm2.5, PM2.5_MA_365, fun = exp, ref.zero = TRUE) %&gt;% \n  setDT()\np2 &lt;- HR %&gt;% \n  ggplot(aes(x = PM2.5_MA_365, y = yhat)) +\n  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.3) +\n  geom_line(linewidth = 1) +\n  theme_classic()\np2"
  },
  {
    "objectID": "5.cohort.html#混合线性模型",
    "href": "5.cohort.html#混合线性模型",
    "title": "队列研究",
    "section": "混合线性模型",
    "text": "混合线性模型\n暂不讲。"
  },
  {
    "objectID": "6.writing.html",
    "href": "6.writing.html",
    "title": "10+文章的写作套路",
    "section": "",
    "text": "标题和摘要\n\n\n引言\n\n疾病负担描述\n环境污染的重要性\n为什么要做这个研究（本文特色在哪）\n简要介绍本文的设计（如文章过长可省略）\n\n\n\n方法\n\n样本/队列地点、分布、数据搜集方式\n环境暴露数据源+暴露评估方式\n主要结局\n协变量筛选策略\n统计模型\n敏感性分析（区分文章质量高低的关键）\n\n\n\n结果\n\n表1\n主要结果表2（未调整的和调整的OR值、HR值）\n剂量反应关系（非线性趋势）\n亚组分析\n敏感性分析\n人群归因危险度（population attributable fraction, PAF）\n\n\n\n讨论\n\n对文章内容的总结。\n对之前类似文献的总结，以及本文贡献和亮点，文章结果的公卫/临床意义。\n对可能的生物学和病理生理机制的描述。\n优势\n劣势\n\n\n\n表格\n图片和表格记得放到文章最后，不要插在正文中。\n充分利用脚注。\n\n\n图片\n图片一定要精美。"
  },
  {
    "objectID": "7.journal.html",
    "href": "7.journal.html",
    "title": "选刊与投稿",
    "section": "",
    "text": "根据主观发表难度进行排序\n\n\n\nLancet Planetary Health IF=28.8 版面费： USD 5,780\nEnvironmental Health Perspectives IF=11.0 版面费：无\nEnvironmental Science & Technology IF=11.4\nJournal of Hazardous Materials IF=14.2\nEnvironment International IF=13.35\nInternational Journal of Epidemiology IF=9.7\nScience of the Total Environment IF=10.8 版面费：无\nEnvironmental Pollution IF=9.988 版面费：无\nChemosphere IF=8.9 版面费：无\nEnvironmental Research IF=8.4\nEcotoxicology and Environmental Safety IF=7.1\nEnvironmental Research Letters IF=6.9\nInternational Journal of Hygiene and Environmental Health IF=7.4\nEnvironmental Health IF=7.1\nJournal of Exposure Science and Environmental Epidemiology IF=5.563\nEnvironmental Science and Pollution Research IF=5.2\nAtmospheric Pollution Research IF=4.831\nAtmospheric Environment IF=4.0\n新刊-Environmental Epidemiology 由ISEE出版，应该会有中等偏上的IF\n\n\n\n\n\nJAMA Network Open IF=13.353 版面费：$3000 USD\nElinicalMedicine IF=17.033 版面费：$5,000 USD\nPLoS Medicine IF=11.613 版面费：$6,300 USD\nThe Lancet Regional Health — Western Pacific IF=8.9 版面费：USD 3,680\nEBioMedicine IF=11.2 版面费：$5,000 USD\nBMC Medicine IF=11.8\niScience IF=6.107 Cell旗下的子杂志，综合类（不限于医学），不知道以后Science出版社会不会出个杂志叫iNature，Nature出版社出个杂志叫iCell\nClinical Medicine IF=5.41\nHeliyon IF=3.776 Cell出版社旗下的杂志\nBMJ Open IF=3\n\n\n\n\n\nInternational Journal of Epidemiology IF=9.685\nAmerican Journal of Epidemiology IF=5.363\nEpidemiology IF=4.822\nJournal of Epidemiology and Community Health IF=6.286 BMJ旗下的期刊\nJournal of Epidemiology and Global Health IF=5.959\nEpidemiology and Health IF=5.919 韩国出版社 排版不错\nJournal of Epidemiology IF=3.809 日本的出版社 排版难看\n新刊-BMJ Public Health to be launched\n\n\n\n\n\nJournal of Public Health IF=5.058\nInternational Journal of Public Health IF=5.1\nPublic Health IF=4.984\nAnnals of Epidemiology IF=6.996\nAmerican Journal of Preventive Medicine IF=6.604\nGlobal Public Health IF=3.356 版面费：$2,650 USD 出版社：Taylor & Francis Group\nBMC Public Health IF=4.135"
  },
  {
    "objectID": "7.journal.html#环境健康类",
    "href": "7.journal.html#环境健康类",
    "title": "选刊与投稿",
    "section": "",
    "text": "Lancet Planetary Health IF=28.8 版面费： USD 5,780\nEnvironmental Health Perspectives IF=11.0 版面费：无\nEnvironmental Science & Technology IF=11.4\nJournal of Hazardous Materials IF=14.2\nEnvironment International IF=13.35\nInternational Journal of Epidemiology IF=9.7\nScience of the Total Environment IF=10.8 版面费：无\nEnvironmental Pollution IF=9.988 版面费：无\nChemosphere IF=8.9 版面费：无\nEnvironmental Research IF=8.4\nEcotoxicology and Environmental Safety IF=7.1\nEnvironmental Research Letters IF=6.9\nInternational Journal of Hygiene and Environmental Health IF=7.4\nEnvironmental Health IF=7.1\nJournal of Exposure Science and Environmental Epidemiology IF=5.563\nEnvironmental Science and Pollution Research IF=5.2\nAtmospheric Pollution Research IF=4.831\nAtmospheric Environment IF=4.0\n新刊-Environmental Epidemiology 由ISEE出版，应该会有中等偏上的IF"
  },
  {
    "objectID": "7.journal.html#综合医学类",
    "href": "7.journal.html#综合医学类",
    "title": "选刊与投稿",
    "section": "",
    "text": "JAMA Network Open IF=13.353 版面费：$3000 USD\nElinicalMedicine IF=17.033 版面费：$5,000 USD\nPLoS Medicine IF=11.613 版面费：$6,300 USD\nThe Lancet Regional Health — Western Pacific IF=8.9 版面费：USD 3,680\nEBioMedicine IF=11.2 版面费：$5,000 USD\nBMC Medicine IF=11.8\niScience IF=6.107 Cell旗下的子杂志，综合类（不限于医学），不知道以后Science出版社会不会出个杂志叫iNature，Nature出版社出个杂志叫iCell\nClinical Medicine IF=5.41\nHeliyon IF=3.776 Cell出版社旗下的杂志\nBMJ Open IF=3"
  },
  {
    "objectID": "7.journal.html#流行病学",
    "href": "7.journal.html#流行病学",
    "title": "选刊与投稿",
    "section": "",
    "text": "International Journal of Epidemiology IF=9.685\nAmerican Journal of Epidemiology IF=5.363\nEpidemiology IF=4.822\nJournal of Epidemiology and Community Health IF=6.286 BMJ旗下的期刊\nJournal of Epidemiology and Global Health IF=5.959\nEpidemiology and Health IF=5.919 韩国出版社 排版不错\nJournal of Epidemiology IF=3.809 日本的出版社 排版难看\n新刊-BMJ Public Health to be launched"
  },
  {
    "objectID": "7.journal.html#公共卫生类",
    "href": "7.journal.html#公共卫生类",
    "title": "选刊与投稿",
    "section": "",
    "text": "Journal of Public Health IF=5.058\nInternational Journal of Public Health IF=5.1\nPublic Health IF=4.984\nAnnals of Epidemiology IF=6.996\nAmerican Journal of Preventive Medicine IF=6.604\nGlobal Public Health IF=3.356 版面费：$2,650 USD 出版社：Taylor & Francis Group\nBMC Public Health IF=4.135"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "引言",
    "section": "",
    "text": "环境健康类研究的特点\n近年来由于环境健康领域研究的热门趋势，环境类英文期刊的影响因子水涨船高。相较于临床和基础类研究，环境健康类人群研究的成果产出周期短，IF 10+杂志多，发文量大，对国人友好，研究门槛相对低，因此十分适合想要冲击IF=10+领域的老师和学生入门，环境健康类期刊具有以下特点：\n\n期刊众多、IF相对高： 2021年环境健康领域IF位于10-20区间的期间有23本， 而临床类相同IF区间的仅13本\n发文量大、国人友好：部分优秀环境类期刊IF&gt;10，年发文量&gt;5000篇，且对中国人比较友好（国人占比40%）\n研究成本低、难度不高： 与费用高、周期长的基础实验相比，环境健康类人群研究往往使用现存的二手数据与环境暴露链接，上手容易且发表周期相对短（3-6个月）。\n\n\n\n课程目的 \n介绍环境暴露的人群健康效应的研究套路、数据分析模型、期刊论文写作、以及相关投稿技巧，争取帮助听众在环境健康类高影响因子的期刊（IF&gt;10）取得发表。\n\n\n课程安排 \n\n第一天\n\n总论（~1H）\n环境暴露评估（~1.5H）理论+文献实例+R代码实战\n\n第二天\n\n时间序列研究（~1.5H）理论+文献实例+R代码实战\n病例交叉研究（~1.5H）理论+文献实例+R代码实战\n\n第三天\n\n横截面研究（~1.5H）理论+文献实例+R代码实战\n队列研究（~1.5H）理论+文献实例+R代码实战\n\n第四天\n\n10+文献的写作（~1.5H）理论+文献实例\n环境健康类文章选刊与投稿（~1.5H）\n\n\n\n\n授课教师 \n近五年以第一作者于JAMA Network Open、Neurology、Environmental Health Perspectives、BMC Medicine、The Lancet Regional Health - Western Pacific、Science of the Total Environment等环境健康和临床流行病等领域发表16篇SCI期刊原创性研究论文。近五年累计被引用1138次，研究论文得到Nature, Nature Medicine, Lancet, BMJ, Circulation等期刊的正面引用，并且得到CNN, U.S. News, AAN, Physicians Weekly等国外主流媒体报道。为Nat. Commun., EClinicalMedicine, J. Am. Soc. Nephrol.等30余种英文期刊审稿。\n\n\n环境健康研究的代表性论文 \n\nCai, M., Li, H., Wu, Y., Zhang. S., Wang. X., Zhang. Z., Lin. H.* (2022) Ambient Air Pollution Associated with Body Fat Percentages at Different Body Compartments: A Cohort Study of UK Biobank Participants. Environmental Health Perspectives (IF=11.0). 130(6): 067702. PDF  DOI: 10.1289/EHP10920\nCai, M., Zhang, S., Lin, X., Qian, Z., McMillin, S.E., Yang, Y., Zhang, Z., Pan, J., Lin, H.. (2022) Association of ambient particulate matter pollution of different sizes with in-hospital case fatality among stroke patients in China. Neurology. (IF=12.3) 98(4), e2474-e2486. PDF  DOI: 10.1212/WNL.0000000000200546\nCai, M., Lin, X., Wang, X., Zhang, S., Qian, Z., McMillin, S.E., Aaron, H.E., Lin, H., Wei, J., Zhang, Z., Pan, J. (2022) Ambient particulate matter pollution of different sizes associated with recurrent stroke hospitalization in China: a cohort study of 1.07 million stroke patients. Science of the Total Environment (IF=10.8). 159104. PDF  DOI: 10.1016/j.scitotenv.2022.159104\nCai, M., Lin, X., Wang, X., Zhang, S., Wang, C., Zhang, Z., Pan, J., Lin, H. (2023). Long-term exposure to ambient fine particulate matter chemical composition and in-hospital case fatality among patients with stroke in China. The Lancet Regional Health-Western Pacific (IF=8.6), 100679. PDF  DOI: 10.1016/j.lanwpc.2022.100679\nCai, M., Wei, J., Zhang, S., Liu, W., Wang, L., Qian, Z., Lin, H., Liu, E., McMillin, S.E., Cao, Y., Yin, P. (2023). Short-term air pollution exposure associated with death from kidney diseases: a nationwide time-stratified case-crossover study in China from 2015 to 2019. BMC Medicine (IF=11.2), 21(1), 32. PDF  DOI: 10.1186/s12916-023-02734-9"
  }
]