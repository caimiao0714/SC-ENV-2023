library(arrow)
install.packages('arrow')
library(arrow)
?write_parquet
(7.5+8.5+6.5+6)/4
(7.5+8.5+6.5+6.5)/4
2/300
pacman::p_load(
arrow, dplyr, ggplot2, data.table, broom, splines, purrr)
cco_pm = arrow::read_parquet(
'Data/cco_synthetic.parquet')
cco_pm
pm_cols = cco_pm %>%
select(starts_with('PM2.5'))
pm_cols = cco_pm %>%
select(starts_with('PM2.5')) %>%
names()
pm_cols
fit_cco = map_dfr(
pm_cols,
fit_clogit,
data = cco_pm)
fit_clogit = function(x, tm_RH_lag = 'MA_07', data = cco_pm){
print(glue::glue('\n----------{x}; {tm_RH_lag}----------\n'))
iqr_x = IQR(data[[x]], na.rm = TRUE)
clean_fit = clogit(
formula = as.formula(paste0("case ~ ",
x,
' + ns(Temperature_',
tm_RH_lag,
', df = 5) + ns(RH_',
tm_RH_lag,
', df = 5)',
' + strata(id)')),
data = data) %>%
broom::tidy() %>%
mutate(OR = exp(estimate*iqr_x), 3,
OR_round = round(exp(estimate*iqr_x), 3),
CI_low = exp(estimate*iqr_x - 1.96*std.error*iqr_x),
CI_high = exp(estimate*iqr_x + 1.96*std.error*iqr_x),
CI_low_round = round(exp(estimate*iqr_x - 1.96*std.error*iqr_x), 3),
CI_high_round = round(exp(estimate*iqr_x + 1.96*std.error*iqr_x), 3),
predictor = x,
iqr = iqr_x,
tm_RH_lag = tm_RH_lag) %>%
mutate(result = paste0(format(OR_round, nsmall = 3),
' (',
format(CI_low_round, nsmall = 3),
'-',
format(CI_high_round, nsmall = 3),
')')) %>%
filter(predictor == term) %>%
mutate(result = gsub('000e\\+00| ', '', result)) %>%
select(predictor, term, iqr, result, OR, CI_low, CI_high, p.value)
return(clean_fit)
}
fit_cco = map_dfr(
pm_cols,
fit_clogit,
data = cco_pm)
pacman::p_load(
arrow, dplyr, ggplot2, data.table, broom, survival, splines, purrr)
fit_cco = map_dfr(
pm_cols,
fit_clogit,
data = cco_pm)
fit_cco
data.table::as.data.table(old.packages())[,.(Package, Installed, ReposVer)]
plot(cars)
reticulate::repl_python()
import os
install.packages('prodlim')
data.table::as.data.table(old.packages())[,.(Package, Installed, ReposVer)]
install.packages(c('mgcv', 'Matrix'))
data.table::as.data.table(old.packages())[,.(Package, Installed, ReposVer)]
library(arrow)
install.packages('arrow')
library(arrow)
?read_parquet
pacman::p_load(metafor)
if (!require ("devtools" )) install.packages ("devtools" )
library (amapR)
devtools :: install github ("xiaojunlin/amapR" ) # 只用运行一次即可
devtools::install_github ("xiaojunlin/amapR" ) # 只用运行一次即可
devtools::install_github ("xiaojunlin/amapR" ) # 只用运行一次即可
devtools::install_github ("xiaojunlin/amapR" ) # 只用运行一次即可
devtools::install_github ("xiaojunlin/amapR" ) # 只用运行一次即可
devtools::install('C:/Users/miaoc/Downloads/amapR-master.zip',
)
devtools::install('C:/Users/miaoc/Downloads/amapR-master'
)
devtools::install('C:/Users/miaoc/Downloads/amapR-master/amapR-master/'
)
#devtools::install_github ("xiaojunlin/amapR" ) # 只用运行一次即可
library(amapR)
options(amap.key = '4768a084468ea82bdae1e370ecbc652a') # 需要去高德地图注册 API key
test address <- data.frame (n = 1:200 , address = c(" 华中科技大学", " 四川大学"))
test_address <- data.frame (n = 1:200 , address = c(" 华中科技大学", " 四川大学"))
system.time ( result <- geocoord (data = test address , address = "address" ) )
system.time ( result <- geocoord (data = test_address , address = "address" ) )
